<!DOCTYPE html>
<html lang="ru" id="htmlRoot" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gal's RNG</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <!-- Google Fonts (Optional, for a more modern look) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Pirata+One&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Background Music Placeholder -->
     <audio id="backgroundMusic" loop>       
    </audio> 

    <div class="container-fluid py-4">
        <header class="text-center mb-4">
            <h1>Gal's RNG</h1>
            <div class="player-stats d-flex justify-content-center align-items-center gap-3 mt-3">
                <div>
                    <span class="currency-icon">üíé</span>
                    <span id="currencyDisplay">0</span> <span data-i18n="ui.prismaticShards">–ü—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–∫–æ–ª–∫–æ–≤</span>
                </div>
                <span data-bs-toggle="tooltip" data-bs-placement="bottom" data-i18n-title="ui.luckTooltipTitle">
                <span data-i18n="ui.luck">üçÄ –£–¥–∞—á–∞</span>: <span id="luckDisplay">1.00</span>
                </span>
            </div>
            <div id="activeBoostsDisplay" class="mt-2 small">
                <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ –±—É—Å—Ç—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>
        </header>

        <main>
            <!-- Roll Section -->
            <section id="rollSection" class="text-center mb-4">
                <div id="rollAnimationContainer" class="roll-animation-container mb-3">
                    <!-- –û–¥–∏–Ω–æ—á–Ω—ã–π —Å–ª–æ—Ç –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ -->
                    <div class="roll-slot-wrapper single-roll-slot-wrapper">
                         <div class="roll-slot" id="rollSlot">
                            <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–¥–∫–æ—Å—Ç–µ–π –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ -->
                        </div>
                    </div>
                    <!-- –°–ª–æ—Ç—ã –¥–ª—è –º—É–ª—å—Ç–∏-—Ä–æ–ª–ª–∞ (—Å–∫—Ä—ã—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                    <div id="multiRollSlotsContainer" class="multi-roll-slots-container d-none">
                        <!-- 5 —Å–ª–æ—Ç–æ–≤ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å JS-–æ–º -->
                    </div>
                </div>

                <div id="rollResultContainer" class="roll-result-container mb-3" style="min-height: 300px;">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–æ–ª–ª–∞ (–∫–∞—Ä—Ç–æ—á–∫–∞) –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </div>
                <button id="rollButton" class="btn btn-primary btn-lg me-2">Roll!</button>
                <button id="multiRollButton" class="btn btn-info btn-lg d-none me-2">Multi-Roll x5</button>
                <button id="autorollButton" class="btn btn-success btn-lg">Autoroll</button>
                <div id="luckyRollDisplay" class="text-center mt-2 small text-info"></div>
            </section>

            <!-- Tabs for Inventory, Shop, Settings -->
            <ul class="nav nav-tabs mb-3" id="mainTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="inventory-tab" data-bs-toggle="tab" data-bs-target="#inventory" type="button" role="tab" aria-controls="inventory" aria-selected="true" data-i18n="ui.inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="shop-tab" data-bs-toggle="tab" data-bs-target="#shop" type="button" role="tab" aria-controls="shop" aria-selected="false" data-i18n="ui.shop">–ú–∞–≥–∞–∑–∏–Ω</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab" aria-controls="settings" aria-selected="false" data-i18n="ui.settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </li>
                <li class="nav-item" role="presentation">
                <button class="nav-link" id="stats-tab" data-bs-toggle="tab" data-bs-target="#stats" type="button" role="tab" aria-controls="stats" aria-selected="false" data-i18n="ui.stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                </li>
            </ul>

            <div class="tab-content" id="mainTabsContent">
                <!-- Inventory Tab -->
                <div class="tab-pane fade show active" id="inventory" role="tabpanel" aria-labelledby="inventory-tab">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2 data-i18n="ui.openedCards">–û—Ç–∫—Ä—ã—Ç—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</h2>
                        <div id="inventoryCounter" class="text-muted">–û—Ç–∫—Ä—ã—Ç–æ: 0 / 0</div>
                    </div>
                    <div id="inventoryGrid" class="row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 g-3">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>
                </div>

                <!-- Shop Tab -->
                <div class="tab-pane fade" id="shop" role="tabpanel" aria-labelledby="shop-tab">
                    <h2 class="mb-3" data-i18n="ui.shop">–ú–∞–≥–∞–∑–∏–Ω</h2>
                    <div class="row">
                        <!-- Boosts -->
                        <div class="col-md-6 mb-4">
                            <h4 data-i18n="ui.boostsTemporary">–ë—É—Å—Ç—ã –£–¥–∞—á–∏ (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ)</h4>
                            <div id="boostShop" class="list-group">
                                <!-- –≠–ª–µ–º–µ–Ω—Ç—ã –±—É—Å—Ç–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ JS -->
                            </div>
                        </div>
                        <!-- Equipment -->
                        <div class="col-md-6 mb-4">
                            <h4 data-i18n="ui.equipmentPermanent">–≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞ (–ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è, –º–∞–∫—Å. 3)</h4>
                            <div id="equipmentShop" class="list-group">
                                <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ JS -->
                            </div>
                            <h5 class="mt-3" data-i18n="ui.equipped">–ù–∞–¥–µ—Ç–æ:</h5>
                            <div id="equippedItemsDisplay" class="d-flex flex-wrap gap-2">
                                <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–¥–µ—Ç–æ–π —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏ -->
                            </div>
                        </div>
                    </div>
                    <hr>
                    <h4 data-i18n="ui.upgrades">–£–ª—É—á—à–µ–Ω–∏—è</h4>
                    <div id="upgradesShop" class="list-group">
                        <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ª—É—á—à–µ–Ω–∏–π –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ JS -->
                    </div>
                    <div id="luckCoreSection" class="mt-4"></div>
                </div>

                <!-- Settings Tab -->
                <div class="tab-pane fade" id="settings" role="tabpanel" aria-labelledby="settings-tab">
                    <h2 class="mb-3" data-i18n="ui.settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                    <h4>–Ø–∑—ã–∫ / Language</h4>
                    <div class="btn-group" role="group" aria-label="Language switch">
                      <button type="button" class="btn btn-outline-secondary" id="lang-ru">–†—É—Å—Å–∫–∏–π</button>
                      <button type="button" class="btn btn-outline-secondary" id="lang-en">English</button>
                    </div>
                    <hr>
                    <h4 data-i18n="ui.dataManagement">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏:</h4>
                    <button id="resetProgressButton" class="btn btn-danger" data-i18n="ui.resetProgress">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
                    <p class="form-text mt-1" data-i18n="ui.resetWarning">–í–Ω–∏–º–∞–Ω–∏–µ! –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –≤—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω–æ.</p>
                    <hr>
                    <h4 data-i18n="ui.musicVolume">–ì—Ä–æ–º–∫–æ—Å—Ç—å –º—É–∑—ã–∫–∏:</h4>
                    <div class="d-flex align-items-center">
                        <input type="range" class="form-range me-2" id="musicVolumeSlider" min="0" max="1" step="0.01" value="0">
                        <span id="musicVolumeLabel">0%</span>
                    </div>
                </div>
                <div class="tab-pane fade" id="stats" role="tabpanel" aria-labelledby="stats-tab">
                <h2 class="mb-3"  data-i18n="ui.playerStats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ò–≥—Ä–æ–∫–∞</h2>
                <div id="playerStatsContainer" class="row">
                    <div class="col-md-6 mb-3"> <!-- –î–æ–±–∞–≤–∏–ª mb-3 –¥–ª—è –æ—Ç—Å—Ç—É–ø–∞ –Ω–∞ –º–∞–ª—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö -->
                        <h4 data-i18n="ui.generalStats">–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h4>
                        <ul class="list-group">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span data-i18n="ui.totalRolls">–í—Å–µ–≥–æ —Ä–æ–ª–ª–æ–≤ —Å–¥–µ–ª–∞–Ω–æ:</span>
                                <span id="statsTotalRolls" class="badge bg-primary rounded-pill">0</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center ">
                                <span data-i18n="ui.uniqueCardsOpened">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç –æ—Ç–∫—Ä—ã—Ç–æ:</span> 
                                <span id="statsUniqueCardsOpened" class="badge bg-primary rounded-pill">0 / 0</span>
                            </li>
                            <!-- <li class="list-group-item d-flex justify-content-between align-items-center">
                                –ü–æ—Ç—Ä–∞—á–µ–Ω–æ –æ—Å–∫–æ–ª–∫–æ–≤ –Ω–∞ —Ä–æ–ª–ª—ã (WIP): 
                                <span id="statsCurrencySpentOnRolls" class="badge bg-primary rounded-pill">0</span>
                            </li> -->
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span data-i18n="ui.currencyFromDuplicates">–ü–æ–ª—É—á–µ–Ω–æ –æ—Å–∫–æ–ª–∫–æ–≤ –∑–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã:</span>
                                <span id="statsCurrencyFromDuplicates" class="badge bg-primary rounded-pill">0</span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-6 mb-3"> <!-- –î–æ–±–∞–≤–∏–ª mb-3 -->
                        <h4 data-i18n="ui.statsByRarity">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç—è–º:</h4>
                        <div id="statsByRarityContainer" class="list-group">
                            <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π —Ä–µ–¥–∫–æ—Å—Ç–∏ -->
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </main>

        <!-- –ù–û–í–´–ô –§–£–¢–ï–† -->
        <footer class="text-center mt-5 mb-3">
            <hr>
            <p class="text-muted small">
                Gal's RNG - Version 0.1.3b "Localization"
            </p>
            <!-- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ —á—Ç–æ-—Ç–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–ø–∏—Ä–∞–π—Ç –∏–ª–∏ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—Å -->
            <p class="text-muted small">&copy; 2025 BigCoolOppai</p>
        </footer>
        <!-- –ö–û–ù–ï–¶ –ù–û–í–û–ì–û –§–£–¢–ï–†–ê -->

        <!-- Modal for displaying full card image -->
        <div class="modal fade" id="cardModal" tabindex="-1" aria-labelledby="cardModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content bg-dark text-light">
                    <div class="modal-header border-secondary">
                        <h5 class="modal-title" id="cardModalLabel" data-i18n="ui.card">–ö–∞—Ä—Ç–æ—á–∫–∞</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <img id="modalCardImage" src="" alt="Card Image" class="img-fluid mb-3" style="max-height: 70vh;">
                        <p id="modalCardRarity" class="mb-1"></p>
                        <p id="modalCardChance" class="text-muted small mb-1"></p>
                        <p id="modalCardDescription"></p>
                        <div id="visualEffectControls" class="mt-3"> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–∫–∏ -->
                        <button id="toggleVisualEffectButton" class="btn btn-sm"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/Flip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/MotionPathPlugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/ScrambleTextPlugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/SplitText.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/TextPlugin.min.js"></script>

    <!-- RoughEase, ExpoScaleEase and SlowMo are all included in the EasePack file -->    
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/EasePack.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/CustomEase.min.js"></script>
    <!-- CustomBounce requires CustomEase -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/CustomBounce.min.js"></script>
    <!-- CustomWiggle requires CustomEase -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/CustomWiggle.min.js"></script>
    <!-- Game Scripts -->
    <script src="js/cards.js"></script>
    <script src="js/saveManager.js"></script>
    <script src="js/localization.js"></script>

    <script src="js/game.js"></script>
    <script src="js/visualEffects.js"></script> <!-- <<--- –ù–û–í–´–ô –§–ê–ô–õ -->
    <script src="js/ui.js"></script>
    <script src="js/debug.js"></script>
    <script>
        // Initial load
        document.addEventListener('DOMContentLoaded', async () => {
            await L.init(); // –ñ–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
            Game.init(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
            UI.init();   // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI
            Debug.init();

            // Placeholder for music toggle if you uncomment the HTML
             const musicToggle = document.getElementById('toggleMusicButton');
             const backgroundMusic = document.getElementById('backgroundMusic');
             if (musicToggle && backgroundMusic) {
                 musicToggle.addEventListener('click', () => {
                     if (backgroundMusic.paused) {
                         backgroundMusic.play().catch(e => console.error("Error playing music:", e));
                         musicToggle.textContent = '–í—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É';
                    } else {
                         backgroundMusic.pause();
                         musicToggle.textContent = '–í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É';
                     }
                 });
             }
        });
    </script>
    <!-- DEBUG PANEL -->
    <div id="debugPanel" style="display: none;">
        <div class="debug-header">
            <h3>–î–µ–±–∞–≥-–ø–∞–Ω–µ–ª—å</h3>
            <button id="debugCloseBtn" class="debug-close-btn">√ó</button>
        </div>

        <div class="debug-section">
            <h4>–í–∞–ª—é—Ç–∞</h4>
            <input type="number" id="debugCurrencyInput" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" value="1000">
            <div class="debug-btn-group">
                <button id="debugAddCurrencyBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button id="debugSpendCurrencyBtn">–û—Ç–Ω—è—Ç—å</button>
                <button id="debugSetCurrencyBtn">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </div>

        <div class="debug-section">
            <h4>–ö–∞—Ä—Ç–æ—á–∫–∏</h4>
            <button id="debugUnlockAllBtn">–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ –∫–∞—Ä—Ç—ã</button>
            <select id="debugCardSelect">
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è --</option>
            </select>
            <button id="debugUnlockOneBtn">–û—Ç–∫—Ä—ã—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é</button>
        </div>

        <div class="debug-section">
            <h4>–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–æ–ª–ª</h4>
            <select id="debugRaritySelect">
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–¥–∫–æ—Å—Ç—å --</option>
            </select>
            <button id="debugGuaranteedRollBtn">–°–¥–µ–ª–∞—Ç—å —Ä–æ–ª–ª</button>
            <small>–í–Ω–∏–º–∞–Ω–∏–µ: —ç—Ç–æ—Ç —Ä–æ–ª–ª –Ω–µ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏, –Ω–æ –æ–±–Ω–æ–≤–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ.</small>
        </div>
    </div>
    <!-- END DEBUG PANEL -->
    <div id="globalGlitchOverlay"></div>
</body>
</html>