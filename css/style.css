/* Общие стили */
body {
    font-family: 'Roboto', sans-serif;
    background-color: #1a1a2e; /* Темно-сине-фиолетовый фон */
    color: #e0e0e0; /* Светло-серый текст */
    min-height: 100vh;
    overflow-x: hidden; /* Предотвращение горизонтального скролла */
}

h1, h2, h3, h4, h5, h6 {
    font-family: 'Orbitron', sans-serif;
    color: #f0f0f0; /* Белый для заголовков */
}

.btn {
    font-family: 'Orbitron', sans-serif;
    transition: all 0.2s ease-in-out;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.btn-primary {
    background-color: #007bff; /* Основной синий Bootstrap */
    border-color: #007bff;
    box-shadow: 0 0 10px #007bff, 0 0 5px #007bff inset;
}
.btn-primary:hover, .btn-primary:focus {
    background-color: #0056b3;
    border-color: #0056b3;
    box-shadow: 0 0 15px #0056b3, 0 0 8px #0056b3 inset;
}

.btn-info {
    background-color: #17a2b8; /* Бирюзовый Bootstrap */
    border-color: #17a2b8;
    box-shadow: 0 0 10px #17a2b8, 0 0 5px #17a2b8 inset;
}
.btn-info:hover, .btn-info:focus {
    background-color: #117a8b;
    border-color: #117a8b;
    box-shadow: 0 0 15px #117a8b, 0 0 8px #117a8b inset;
}

.btn-danger {
    box-shadow: 0 0 10px #dc3545, 0 0 5px #dc3545 inset;
}
.btn-danger:hover, .btn-danger:focus {
    box-shadow: 0 0 15px #c82333, 0 0 8px #c82333 inset;
}


.nav-tabs .nav-link {
    color: #adb5bd; /* Цвет неактивных вкладок */
    border: 1px solid transparent;
    border-bottom-color: #343a40; /* Темная граница под вкладками */
}

.nav-tabs .nav-link.active {
    color: #f0f0f0; /* Цвет активной вкладки */
    background-color: #2c2c44; /* Фон активной вкладки, чуть светлее основного фона */
    border-color: #495057 #495057 #2c2c44;
    box-shadow: 0 -2px 5px rgba(73, 80, 87, 0.5) inset;
}

.tab-content {
    background-color: #232339; /* Фон для содержимого вкладок */
    padding: 20px;
    border: 1px solid #343a40;
    border-top: none;
    border-radius: 0 0 .25rem .25rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.list-group-item {
    background-color: #2a2a40; /* Фон элементов списка в магазине */
    border-color: #343a40;
}
.list-group-item strong {
    color: #e0e0e0;
}
.list-group-item .badge {
    font-size: 0.9em;
}

.currency-icon {
    font-size: 1.2em;
    margin-right: 0.2em;
}

/* Стили для анимации ролла */
.roll-animation-container {
    display: flex; /* Для мульти-ролла */
    justify-content: center; /* Для мульти-ролла */
    align-items: center; /* Для мульти-ролла */
    width: 100%;
    height: 80px; /* Высота контейнера анимации */
    background-color: #111; /* Темный фон для анимации */
    border: 2px solid #444;
    border-radius: 5px;
    overflow: hidden; /* Важно для эффекта прокрутки */
    position: relative; /* Для центральной линии */
    box-shadow: inset 0 0 15px rgba(0,0,0,0.7);
}

.roll-slot-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    position: relative; /* Для маркера */
}



.roll-slot {
    width: 90%; /* Чтобы было немного отступов от краев .roll-animation-container */
    /* max-width: 250px; */ /* Можно ограничить максимальную ширину */
    margin: 0 auto; /* Центрируем сам слот, если он меньше 100% */
    height: 100%;
    display: flex; /* Для выравнивания текста внутри */
    justify-content: center;
    align-items: center;
    font-size: 1.8em; /* Размер шрифта для названия редкости */
    font-weight: bold;
    text-align: center;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
    border-radius: 5px; /* Скруглим углы */
    transition: background-color 0.1s ease-out, color 0.1s ease-out, transform 0.1s ease-out; /* Плавность смены */
    /* Убираем transform, он нам не нужен для translateX */
}
.roll-slot.fast-roll {
    transition-duration: 0.75s; /* Ускоренная анимация */
}


/* Стили для разных редкостей (примеры, будут дополняться в JS) */
/* Новый стиль для "Хлама" */
.rarity-garbage { color: #e0e0e0; background: linear-gradient(135deg, #795548, #5d4037); }
.rarity-common { color: #9e9e9e; background: linear-gradient(135deg, #616161, #424242); }
.rarity-rare { color: #e0e0e0; background: linear-gradient(135deg, #2196f3, #1976d2); }
.rarity-epic { color: #e0e0e0; background: linear-gradient(135deg, #9c27b0, #7b1fa2); }
.rarity-legendary { color: #212121; background: linear-gradient(135deg, #ff9800, #fb8c00); text-shadow: 0 0 5px #fff, 0 0 10px #ffeb3b; }
.rarity-mythic { color: #fff; background: linear-gradient(135deg, #f44336, #d32f2f); text-shadow: 0 0 8px #fff, 0 0 15px #ff5252, 0 0 5px #000; }

/* Стили для разных редкостей теперь будут применяться к .roll-slot */
/* Например, в JS будем делать: rollSlot.className = 'roll-slot rarity-mythic'; */
.roll-slot.rarity-common { color: #9e9e9e; background: linear-gradient(135deg, #616161, #424242); }
.roll-slot.rarity-rare { color: #e0e0e0; background: linear-gradient(135deg, #2196f3, #1976d2); }
.roll-slot.rarity-epic { color: #e0e0e0; background: linear-gradient(135deg, #9c27b0, #7b1fa2); }
.roll-slot.rarity-legendary { color: #212121; background: linear-gradient(135deg, #ff9800, #fb8c00); text-shadow: 0 0 5px #fff, 0 0 10px #ffeb3b; }
.roll-slot.rarity-mythic { color: #fff; background: linear-gradient(135deg, #f44336, #d32f2f); text-shadow: 0 0 8px #fff, 0 0 15px #ff5252, 0 0 5px #000; }
.roll-slot.rarity-garbage { color: #e0e0e0; background: linear-gradient(135deg, #795548, #5d4037); }
/* Стили для Unbound */
.roll-slot.rarity-unbound {
    color: #f3e5f5; /* Очень светлый, почти белый сиреневый текст */
    background: linear-gradient(135deg, #8e24aa 0%, #6a1b9a 50%, #4a148c 100%); /* Глубокий фиолетовый градиент */
    text-shadow: 0 0 5px #fff, 0 0 10px #d1c4e9, 0 0 15px #7e57c2;
    box-shadow: inset 0 0 10px rgba(206, 147, 216, 0.3); /* Легкое внутреннее свечение */
}

/* Стили для Uranium */
.roll-slot.rarity-uranium {
    color: #002000; /* Очень темный зеленый, почти черный текст для контраста */
    background: linear-gradient(135deg, #76ff03 0%, #64dd17 60%, #aeea00 100%); /* Ярко-зеленый градиент */
    text-shadow: 0 0 3px #fff, 0 0 6px #c6ff00, 0 0 9px #76ff03;
    border: 1px solid rgba(255,255,255,0.2); /* Легкая рамка для четкости */
}


#gameWrapper {
  /* Задаем значения по умолчанию (нет фильтра) */
  --invert: 0;
  --grayscale: 0;
  --hue-rotate: 0deg;
  --saturate: 1;
  --contrast: 1;
  --brightness: 1;

  /* Применяем фильтры, используя наши переменные */
  filter: 
    invert(var(--invert))
    grayscale(var(--grayscale))
    hue-rotate(var(--hue-rotate))
    saturate(var(--saturate))
    contrast(var(--contrast))
    brightness(var(--brightness));
  
  /* Плавный переход при снятии эффекта */
  transition: filter 0.5s ease-out; 
}


/* Стили для ERROR */
.roll-slot.rarity-error {
    font-family: 'Courier New', Courier, monospace; /* Моноширинный шрифт для "технического" вида */
    color: #ff5252; /* Ярко-красный текст */
    background-color: #111; /* Очень темный фон */
    text-shadow: 0 0 5px #ff1744, 0 0 10px #ff1744, 2px 2px 0px #00e5ff, -2px -2px 0px #e91e63; /* Глитч-эффект для текста */
    animation: error-text-glitch 0.1s infinite steps(1, end) alternate, error-bg-flicker 0.5s infinite linear;
    position: relative;
    overflow: hidden;
    border: 1px dashed #555;
}
.roll-slot.rarity-error::before,
.roll-slot.rarity-error::after {
    content: attr(data-text); /* Будем передавать текст через data-атрибут */
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #111;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
}
.roll-slot.rarity-error::before {
    left: 2px;
    text-shadow: -2px 0 #00e5ff; /* Cyan */
    clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
    animation: error-glitch-anim-1 1.5s infinite linear alternate-reverse;
}
.roll-slot.rarity-error::after {
    left: -2px;
    text-shadow: 2px 0 #e91e63; /* Pink */
    clip-path: polygon(0 50%, 100% 50%, 100% 100%, 0 100%);
    animation: error-glitch-anim-2 2s infinite linear alternate-reverse;
}

@keyframes error-text-glitch {
    0% { transform: translate(0,0); }
    100% { transform: translate(2px, -1px) skewX(-5deg); }
}
@keyframes error-bg-flicker {
    0%, 100% { background-color: #111; }
    50% { background-color: #000; }
}
@keyframes error-glitch-anim-1 {
    0% { clip-path: polygon(0 2%, 100% 2%, 100% 5%, 0 5%); }
    10% { clip-path: polygon(0 15%, 100% 15%, 100% 20%, 0 20%); }
    /* ... (больше шагов для плавности и разнообразия) ... */
    100% { clip-path: polygon(0 60%, 100% 60%, 100% 80%, 0 80%); }
}
@keyframes error-glitch-anim-2 {
    0% { clip-path: polygon(0 80%, 100% 80%, 100% 85%, 0 85%); }
    15% { clip-path: polygon(0 40%, 100% 40%, 100% 43%, 0 43%); }
    /* ... (больше шагов для плавности и разнообразия) ... */
    100% { clip-path: polygon(0 10%, 100% 10%, 100% 35%, 0 35%); }
}


/* Стили для Devil (Макима) */
.roll-slot.rarity-devil {
    color: #f5e6e6; /* Очень светлый, почти белый с розовым оттенком текст */
    background: linear-gradient(145deg, #210000 0%, #5c0c0c 40%, #8d1313 70%, #a01c1c 100%);
    /* Можно добавить тонкий паттерн спиралей или цепей на фон через background-image */
    text-shadow: 0 0 6px #fff, 0 0 10px #ff8a80, 0 0 2px #000;
    border: 1px solid #3d0000;
    font-family: 'Georgia', 'Times New Roman', serif; /* Элегантный, но строгий шрифт */
    letter-spacing: 0.05em;
}


/* Стили для Jackpot (Хакари) */
.roll-slot.rarity-jackpot {
    color: #422B00; /* Темно-коричневый, почти черный текст */
    background: 
        radial-gradient(ellipse at center, rgba(255,236,179,0.8) 0%, rgba(255,209,128,0.5) 40%, rgba(255,179,0,0.2) 70%, rgba(255,179,0,0) 100%),
        linear-gradient(45deg, #FFD700, #FFA000, #FF6F00, #FFB300);
    background-blend-mode: overlay, normal;
    text-shadow: 0 0 5px rgba(255,255,255,0.9), 0 0 10px #fff59d, 0 0 15px #ffeb3b;
    font-weight: 900;
    font-family: 'Impact', Haettenschweiler, 'Arial Narrow Bold', sans-serif; /* "Шумный", казино-стиль */
    animation: jackpot-pulse-glow 1s infinite alternate;
    border: 2px outset #FFCA28; /* Выпуклая золотая рамка */
}
@keyframes jackpot-pulse-glow {
    from {
        text-shadow: 0 0 5px rgba(255,255,255,0.9), 0 0 10px #fff59d, 0 0 15px #ffeb3b;
        box-shadow: inset 0 0 15px #ffe082, 0 0 5px #ffc107;
    }
    to {
        text-shadow: 0 0 8px rgba(255,255,255,1), 0 0 18px #fff9c4, 0 0 25px #ffecb3;
        box-shadow: inset 0 0 25px #fff176, 0 0 15px #ffd54f;
    }
}

/* Стили для Timestop (Дио) */
.roll-slot.rarity-timestop {
    color: #212121; /* Темный текст на ярком фоне */
    background: 
        repeating-linear-gradient(
            -55deg,
            #FDD835,
            #FDD835 10px,
            #FBC02D 10px,
            #FBC02D 20px
        ); /* Диагональные полосы двух оттенков желтого */
    text-shadow: 1px 1px 0px #FFFDE7, -1px -1px 0px #FFF9C4, 0 0 8px rgba(0,0,0,0.3);
    font-family: 'Cinzel Decorative', cursive; /* Декоративный, "царственный" шрифт */
    font-weight: bold;
    border: 2px solid #F57F17; /* Темно-оранжевая рамка */
    animation: timestop-bg-scroll 20s linear infinite; /* Медленная прокрутка фона */
    position: relative;
}
.roll-slot.rarity-timestop::after { /* Эффект "ауры" или трескающегося времени */
    content: " 時間が止まっている "; /* Текст на тайском "Остановка времени" - отсылка к ZA WARUDO, можно заменить на "ZA WARUDO!" или иконку */
    font-family: sans-serif; /* Обычный шрифт для символов */
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(1.5);
    color: rgba(0, 0, 0, 0.15); /* Полупрозрачный темный текст на фоне */
    font-size: 1.5em; /* Большой размер для фона */
    font-weight: bold;
    z-index: -1; /* Позади основного текста */
    opacity: 0.5;
}
@keyframes timestop-bg-scroll {
    0% { background-position: 0 0; }
    100% { background-position: -400px 400px; } /* Значения для прокрутки фона */
}

/* Мигающая анимация для Exalted или подобных очень редких */
.rarity-exalted-example { /* Пример, если будет такая редкость */
    color: #fff;
    background: linear-gradient(135deg, #ffd700, #ffc107);
    text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff0;
    animation: exalted-glow 1s infinite alternate;
}
@keyframes exalted-glow {
    from { box-shadow: 0 0 5px #ffd700, 0 0 10px #ffd700 inset; }
    to { box-shadow: 0 0 20px #ffeb3b, 0 0 30px #ffeb3b inset; }
}


/* Для мульти-ролла: каждый слот будет маленькой версией этого */
.multi-roll-slots-container {
    display: flex;
    justify-content: space-around;
    width: 100%;
    height: 100%;
}
.multi-roll-slot-wrapper { /* Этот остается как контейнер для каждого мини-слота */
    flex: 1; 
    margin: 0 5px;
    border: 1px solid #333;
    border-radius: 4px;
    overflow: hidden; /* Важно, если вдруг текст будет вылезать */
    position: relative; /* Маркер для мульти-слотов можно убрать, если не нужен */
    background-color: #181818;
    height: 100%;
    display: flex; /* Для центрирования roll-slot внутри */
    justify-content: center;
    align-items: center;
}

.multi-roll-slot-wrapper .roll-slot { /* Стили для roll-slot внутри мульти-ролла */
    width: 95%; /* Чуть больше, чтобы занять почти весь mini-wrapper */
    font-size: 1em; /* Меньший шрифт для мульти-ролла */
    padding: 5px;
    line-height: 1.2; /* Для лучшего отображения коротких названий */
}
/* Анимация "встряски" при остановке (опционально) */
.roll-slot.landed {
    animation: land-shake 0.3s cubic-bezier(.36,.07,.19,.97) both;
}
.multi-roll-slots-container .rarity-item {
    min-width: 100px; /* Меньшая ширина для мульти-ролла */
    font-size: 1em; /* Меньший шрифт */
    padding: 0 10px;
}

@keyframes land-shake {
    10%, 90% { transform: translate3d(-1px, 0, 0) scale(1.02); }
    20%, 80% { transform: translate3d(2px, 0, 0) scale(1.02); }
    30%, 50%, 70% { transform: translate3d(-2px, 0, 0) scale(1.02); }
    40%, 60% { transform: translate3d(2px, 0, 0) scale(1.02); }
  }


/* Стили для результата ролла (полученной карточки) */
.roll-result-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px;
}
.received-card-animation-wrapper {
    perspective: 1000px; /* Для 3D эффекта появления */
}
.received-card {
    width: 200px; /* Ширина отображаемой карточки */
    /* height: auto; вычисляется из aspect-ratio */
    aspect-ratio: 1024 / 1360; /* Сохраняем пропорции */
    border: 3px solid #fff;
    border-radius: 10px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.4), 0 0 15px var(--rarity-glow-color, transparent); /* Цвет свечения будет задаваться JS */
    background-color: #333; /* Фоллбэк, если изображение не загрузится */
    background-size: cover;
    background-position: center;
    margin-bottom: 15px;
    animation: card-appear 0.7s ease-out forwards;
    transform-style: preserve-3d; /* Для анимаций */
}
@keyframes card-appear {
    0% { transform: translateY(50px) rotateY(-30deg) scale(0.8); opacity: 0; }
    100% { transform: translateY(0) rotateY(0deg) scale(1); opacity: 1; }
}
.received-card-name {
    font-size: 1.5em;
    font-weight: bold;
    margin-top: 5px;
    animation: text-fade-in 0.5s 0.5s ease-out forwards;
    opacity: 0;
}
@keyframes text-fade-in {
    0% { opacity: 0; transform: translateY(10px); }
    100% { opacity: 1; transform: translateY(0); }
}
.duplicate-reward-text {
    font-size: 1.1em;
    color: #ffd700; /* Золотой для награды */
    margin-top: 5px;
    animation: text-fade-in 0.5s 0.7s ease-out forwards;
    opacity: 0;
}

/* Стили для инвентаря */
.inventory-card {
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    border: 2px solid transparent; /* Граница будет цветной в зависимости от редкости */
    background-color: #2c2c44;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    cursor: pointer;
    aspect-ratio: 1024 / 1360; /* Сохраняем пропорции превью */
}
.inventory-card:hover {
    transform: translateY(-5px) scale(1.03);
    box-shadow: 0 8px 16px rgba(0,0,0,0.4), 0 0 15px var(--rarity-glow-color, #777);
}
.inventory-card-image {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Или 'contain' если хотите видеть всю карточку, но могут быть поля */
    display: block;
}
.inventory-card-name {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 8px;
    font-size: 0.9em;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}


/* Магазин - стили для купленных/надетых предметов */
.shop-item.purchased .btn, .shop-item.equipped .btn {
    opacity: 0.6;
    cursor: not-allowed;
}
.equipped-item-chip {
    background-color: #3a3a52;
    padding: 5px 10px;
    border-radius: 15px;
    font-size: 0.9em;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
.equipped-item-chip .btn-remove-equip {
    font-size: 0.7em;
    padding: 0.1em 0.4em;
    margin-left: 5px;
}

/* Настройки */
#skipAnimationSettings .form-check {
    padding-left: 2.5em; /* Больше места для кастомного чекбокса (если будет) */
}
#skipAnimationSettings .form-check-label {
    padding-top: 0.1em;
}

/* Модальное окно */
#cardModal .modal-content {
    border: 2px solid #444;
    box-shadow: 0 0 25px rgba(0,0,0,0.5);
}
#modalCardRarity {
    font-weight: bold;
}

/* Адаптивность */
@media (max-width: 768px) {
    .rarity-item {
        min-width: 120px;
        font-size: 1.2em;
    }
    .received-card {
        width: 150px;
    }
    .multi-roll-slots-container .rarity-item {
        min-width: 80px;
        font-size: 0.8em;
    }
}
@media (max-width: 576px) {
    h1 { font-size: 1.8em; }
    .player-stats { flex-direction: column; gap: 0.5rem;}
    .roll-animation-container { height: 60px; }
    .rarity-item {
        min-width: 100px;
        font-size: 1em;
    }
    .btn-lg {
        padding: .5rem 1rem;
        font-size: 1rem;
    }
    .multi-roll-slots-container {
        /* Можно сделать, чтобы они переносились, если не влезают */
        /* flex-wrap: wrap; */
        /* height: auto;  Если переносятся, высота должна быть auto */
    }
    .multi-roll-slots-container .rarity-item {
        min-width: 60px; /* Еще меньше, чтобы влезло 5 на маленьких экранах */
        font-size: 0.7em;
        padding: 0 5px;
    }
}
/* css/style.css */
.inventory-card.locked {
    background-color: #343a40; /* Темный фон */
    cursor: default;
    border-color: #495057; /* Темная граница */
    position: relative; /* Для позиционирования вопросительного знака */
}
.inventory-card.locked:hover {
    transform: none; /* Убираем эффект ховера */
    box-shadow: 0 4px 8px rgba(0,0,0,0.3); /* Оставляем базовую тень */
}
.inventory-card.locked .inventory-card-image {
    opacity: 0.1; /* Делаем изображение (если оно есть) почти невидимым */
    filter: grayscale(100%) blur(2px);
}
.inventory-card.locked .inventory-card-name {
    background: rgba(0,0,0,0.5);
    color: #adb5bd;
    font-style: italic;
}
.inventory-card.locked::after { /* Вопросительный знак */
    content: '?';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 3em; /* Размер знака вопроса */
    color: rgba(255, 255, 255, 0.3);
    font-weight: bold;
    z-index: 2;
}

#globalGlitchOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9999;
    display: none; /* По умолчанию скрыт */
    background: transparent; 
    overflow: hidden; /* Важно для псевдоэлементов и линий */
}

#globalGlitchOverlay.active-effect-error {
    display: block;
    animation: screen-shake 0.05s infinite linear alternate; /* Основной тремор экрана */
}

/* Псевдоэлементы для цветных глитч-слоев, когда #globalGlitchOverlay.active-effect-error активен */
#globalGlitchOverlay.active-effect-error::before,
#globalGlitchOverlay.active-effect-error::after {
    content: ""; /* Важно для отображения псевдоэлементов */
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0.4; /* Сделаем их чуть менее интенсивными для начала */
} 


/* Мы будем создавать слои для красного и цианового глитча через JS */
.glitch-color-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0; /* GSAP будет управлять opacity */
}

/* Стили для динамически создаваемых линий */
.glitch-line {
    position: absolute; 
    left: 0;
    width: 100%;
    opacity: 0; /* GSAP будет управлять opacity */
}

/* Анимации (эти остаются как есть) */
@keyframes screen-shake {
    0% { transform: translate(1px, 1px) rotate(0.1deg); }
    25% { transform: translate(-1px, 1px) rotate(-0.05deg); }
    50% { transform: translate(-1px, -1px) rotate(-0.1deg); }
    75% { transform: translate(1px, -1px) rotate(0.05deg); }
    100% { transform: translate(1px, -1px) rotate(0.1deg); }
}

@keyframes glitch-color-shift-red {
    0% { transform: translateX(3px) translateY(-1px); }
    100% { transform: translateX(-3px) translateY(1px); }
}
@keyframes glitch-color-shift-cyan {
    0% { transform: translateX(-2px) translateY(2px); }
    100% { transform: translateX(2px) translateY(-2px); }
}


/* --- Эффект для Uranium (Ураночка) --- */
body.visual-effect-uranium::before {
    content: '';
    position: fixed;
    /* Делаем свечение чуть меньше, чтобы оно не было слишком навязчивым, 
       используем отрицательные значения для top/left/right/bottom, 
       чтобы box-shadow мог "выйти" за пределы экрана */
    top: -20px; 
    left: -20px; 
    right: -20px; 
    bottom: -20px;
    /* Внутренняя тень создает эффект свечения от краев экрана,
       внешняя тень создает общую ауру вокруг */
    box-shadow: 
        inset 0 0 30px 15px rgba(118, 255, 3, 0.35), /* Внутреннее зеленое свечение */
        0 0 35px 10px rgba(118, 255, 3, 0.25);      /* Внешняя зеленая аура */
    opacity: 0; /* Начальная прозрачность для анимации */
    pointer-events: none; /* Чтобы не мешало взаимодействию */
    z-index: 9990; /* Под глитч-оверлеем, если он есть, но выше остального контента */
    animation: uranium-glow-pulse 2.5s infinite alternate ease-in-out;
    border-radius: 30px; /* Скругляем углы свечения, чтобы было мягче */
}

@keyframes uranium-glow-pulse {
    0% { 
        opacity: 0.6; 
        transform: scale(0.98); 
        box-shadow: 
            inset 0 0 25px 10px rgba(118, 255, 3, 0.3),
            0 0 25px 5px rgba(118, 255, 3, 0.2);
    }
    100% { /* В середине пульсации делаем свечение ярче и чуть больше */
        opacity: 0.9; 
        transform: scale(1.00); 
        box-shadow: 
            inset 0 0 40px 20px rgba(180, 255, 87, 0.45), /* Более светлый оттенок для пика */
            0 0 45px 15px rgba(180, 255, 87, 0.35);
    }
}


/* --- Стили для COSMIC (Темная) редкости в ролле --- */
.roll-slot.rarity-cosmic {
    color: #b39ddb; /* Приглушенный фиолетовый текст */
    background: 
        radial-gradient(ellipse at center, rgba(49, 27, 146, 0.5) 0%, transparent 70%), /* Темное внутреннее свечение */
        linear-gradient(180deg, #1A0B3F 0%, #231152 40%, #311b92 70%, #1C0A38 100%); /* Очень темный фиолетово-черный градиент */
    text-shadow: 0 0 8px rgba(126, 87, 194, 0.7), 0 0 3px #000;
    font-family: 'Cinzel Decorative', cursive; /* Шрифт с "древним" или "загадочным" ощущением */
    font-weight: bold;
    border: 1px solid #2c0b50;
    box-shadow: inset 0 0 20px rgba(10, 5, 30, 0.8);
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-cosmic::before { /* Эффект "черной дыры" или "искривления" */
    content: "";
    position: absolute;
    width: 150%; height: 150%;
    top: -25%; left: -25%;
    background: radial-gradient(circle, transparent 30%, rgba(10, 5, 20, 0.6) 60%, rgba(5, 0, 10, 0.8) 80%);
    animation: cosmic-vortex-spin 30s linear infinite;
    opacity: 0.7;
}
@keyframes cosmic-vortex-spin {
    0% { transform: rotate(0deg) scale(1); }
    100% { transform: rotate(360deg) scale(1.1); }
}
.roll-slot.rarity-cosmic > span { position: relative; z-index: 1; }


/* --- Стили для MOTIVATION (Вергилий) редкости в ролле --- */
.roll-slot.rarity-motivation {
    color: #e3f2fd; /* Светло-голубой, почти белый текст */
    background: 
        linear-gradient(to bottom, rgba(255,255,255,0.1) 0%,rgba(255,255,255,0) 20%), /* Легкий блик сверху */
        linear-gradient(170deg, #0D47A1 0%, #1565C0 45%, #1976D2 65%, #0B3C8A 100%); /* Строгий синий градиент */
    text-shadow: 0 0 10px #81d4fa, 0 0 18px #4fc3f7, 0 0 2px #000;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; /* Четкий, современный, без засечек */
    font-weight: 600; /* Полужирный */
    letter-spacing: 0.03em;
    border: 1px solid #0d47a1; /* Темно-синяя рамка */
    box-shadow: inset 0 0 10px rgba(25, 118, 210, 0.5), 0 0 5px rgba(79, 195, 247, 0.3);
    position: relative;
    overflow: hidden;
}
/* Эффект "концентрированной энергии" или "режущих линий" */
.roll-slot.rarity-motivation::after {
    content: "";
    position: absolute;
    top: 10%; left: -50%;
    width: 200%; height: 80%;
    background: 
        repeating-linear-gradient(
            75deg, /* Угол наклона линий */
            transparent,
            transparent 8px,
            rgba(129, 212, 250, 0.1) 8px, /* Полупрозрачные голубые линии */
            rgba(129, 212, 250, 0.1) 10px
        );
    opacity: 0.8;
    animation: motivation-lines-scroll 3s linear infinite;
    pointer-events: none;
}
@keyframes motivation-lines-scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(20px); } /* Сдвиг для эффекта движения линий */
}
.roll-slot.rarity-motivation > span { position: relative; z-index: 1; }


/* --- Стили для SMOKINSEXYSTYLE (Данте Ж) редкости в ролле --- */
.roll-slot.rarity-smokinsexystyle { /* или rarity-sss */
    color: #ffebee; /* Очень светлый красноватый текст */
    background: 
        linear-gradient(45deg, rgba(0,0,0,0.4) 0%, transparent 50%, rgba(0,0,0,0.4) 100%), /* Диагональные тени */
        linear-gradient(135deg, #B71C1C 0%, #D32F2F 40%, #E53935 70%, #C62828 100%); /* Насыщенный красный градиент */
    text-shadow: 0 0 8px #ffcdd2, 0 0 15px #ef9a9a, 0 0 2px #000;
    font-family: 'Playfair Display SC', serif; /* Стильный шрифт с засечками, немного "готичный" */
    font-weight: bold;
    text-transform: uppercase; /* Для дерзости */
    border: 1px solid #7f0000; /* Темно-красная рамка */
    box-shadow: inset 0 0 15px rgba(0,0,0,0.6), 0 0 10px rgba(255,82,82,0.4);
    position: relative;
    overflow: hidden;
}
/* Эффект "демонического огня" или "искр" */
.roll-slot.rarity-smokinsexystyle::before {
    content: "";
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background-image: radial-gradient(circle at 3px 5px, rgba(255,138,101,0.6) 1px, transparent 0),  /* Оранжевые искры */
                      radial-gradient(circle at 8px 2px, rgba(255,205,210,0.5) 1px, transparent 0); /* Розовые искры */
    background-size: 25px 25px;
    opacity: 0;
    animation: sss-sparks-fade 1.5s ease-out infinite;
}
@keyframes sss-sparks-fade {
    0%, 100% { opacity: 0; transform: scale(0.8) rotate(0deg); }
    50% { opacity: 0.6; transform: scale(1.1) rotate(10deg); }
}
.roll-slot.rarity-smokinsexystyle > span { position: relative; z-index: 1; }


/* --- Стили для SPACE (Светлая) редкости в ролле --- */
.roll-slot.rarity-space {
    color: #004d40; /* Темный бирюзовый текст для контраста */
    background: 
        radial-gradient(ellipse at 50% 100%, rgba(224, 247, 250, 0.4) 0%, transparent 60%), /* Свечение снизу */
        linear-gradient(30deg, #E0F7FA 0%, #B2EBF2 30%, #80DEEA 60%, #4DD0E1 100%); /* Светлый циан-бирюзовый градиент */
    text-shadow: 0 0 6px #fff, 0 0 12px #e0f7fa, 1px 1px 1px rgba(0,0,0,0.1);
    font-family: 'Quicksand', sans-serif; /* Легкий, воздушный шрифт */
    font-weight: 500;
    border: 1px solid #b2ebf2; /* Светлая рамка */
    box-shadow: inset 0 0 10px rgba(255,255,255,0.5), 0 0 8px rgba(178, 235, 242, 0.5);
    position: relative;
    overflow: hidden;
}
/* Эффект "звездной пыли" или "сияющих частиц" */
.roll-slot.rarity-space::after {
    content: "";
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: 
        repeating-radial-gradient(circle at 20% 30%, rgba(255,255,255,0.2) 0, transparent 1px, transparent 10px),
        repeating-radial-gradient(circle at 80% 70%, rgba(255,255,255,0.15) 0, transparent 1px, transparent 15px);
    background-size: 100% 100%; /* Чтобы градиенты покрывали всю область */
    opacity: 0;
    animation: space-dust-shimmer 4s ease-in-out infinite alternate;
}
@keyframes space-dust-shimmer {
    0% { opacity: 0.3; transform: scale(1) rotate(0deg); }
    100% { opacity: 0.7; transform: scale(1.05) rotate(5deg); }
}
.roll-slot.rarity-space > span { position: relative; z-index: 1; }



/* Стили для Berserk (Яростная) */
.roll-slot.rarity-berserk {
    color: #ffcdd2; /* Светло-красный текст */
    background: 
        linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)),
        repeating-linear-gradient(
            -45deg,
            #c62828,
            #c62828 5px,
            #b71c1c 5px,
            #b71c1c 10px
        ); /* Диагональные полосы, как царапины + затемнение */
    background-blend-mode: overlay, normal;
    text-shadow: 0 0 6px #ff8a80, 0 0 1px #000, 0 0 2px #000;
    font-family: 'Impact', Haettenschweiler, 'Arial Narrow Bold', sans-serif;
    text-transform: uppercase;
    border: 1px solid #8e0000;
}


/* Стили для Bee (Жужжащая) */
.roll-slot.rarity-bee {
    color: #212121; /* Темный текст для контраста */
    background: repeating-linear-gradient(
        135deg,
        #FFD54F,
        #FFD54F 15px,
        #212121 15px,
        #212121 30px
    ); /* Черно-желтые полосы */
    text-shadow: 0 0 4px #fff, 1px 1px 2px rgba(0,0,0,0.5);
    border: 2px solid #ffb300;
    font-weight: bold;
}


/* Стили для Russian (Родная) */
.roll-slot.rarity-russian {
    color: #f5f5f5; /* Светло-серый/белый текст */
    background: linear-gradient(160deg, #d32f2f 0%, #b71c1c 50%, #7f0000 100%); /* Глубокий красный градиент */
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.4), 1px 1px 3px rgba(0,0,0,0.7);
    border: 1px solid rgba(255,255,255,0.2);
    font-family: 'Playfair Display SC', serif;
}

/* Стили для Blackhole (Сверхмассивная) - ОБНОВЛЕНО */
.roll-slot.rarity-blackhole {
    color: #ffca28; /* Яркий желто-оранжевый текст */
    background: radial-gradient(ellipse at center, #111 0%, #000 70%); /* От темно-серого к черному для эффекта глубины */
    text-shadow: 0 0 5px #ffab00, 0 0 10px #ff6d00, 0 0 15px #e65100; /* Многослойное огненное свечение текста */
    border: 1px solid #E65100; /* Рамка в цвет аккреционного диска */
    font-family: 'Orbitron', sans-serif;
    animation: blackhole-orange-pulse 4s infinite alternate ease-in-out;
}

@keyframes blackhole-orange-pulse {
    from {
        box-shadow: inset 0 0 20px rgba(40, 20, 0, 0.8);
        letter-spacing: 0.02em;
    }
    to {
        box-shadow: inset 0 0 35px rgba(230, 81, 0, 0.5);
        letter-spacing: 0.05em;
    }
}


/* --- DEBUG PANEL STYLES --- */
#debugPanel {
    position: fixed;
    top: 10px;
    right: 10px;
    width: 300px;
    background-color: #2c2c44;
    border: 2px solid #6c757d;
    border-radius: 8px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.5);
    z-index: 10000;
    color: #f0f0f0;
    padding: 15px;
    font-family: 'Roboto', sans-serif;
}

#debugPanel .debug-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #495057;
    padding-bottom: 10px;
    margin-bottom: 15px;
}

#debugPanel h3, #debugPanel h4 {
    font-family: 'Orbitron', sans-serif;
    margin: 0;
}

#debugPanel h4 {
    font-size: 1.1em;
    margin-bottom: 10px;
}

#debugPanel .debug-section {
    margin-bottom: 15px;
}
#debugPanel .debug-section:last-child {
    margin-bottom: 0;
}

#debugPanel input, #debugPanel select, #debugPanel button {
    width: 100%;
    padding: 8px;
    margin-bottom: 8px;
    border-radius: 4px;
    border: 1px solid #6c757d;
    background-color: #3a3a52;
    color: #f0f0f0;
    font-size: 14px;
}

#debugPanel button {
    background-color: #007bff;
    border-color: #007bff;
    cursor: pointer;
    transition: background-color 0.2s;
}
#debugPanel button:hover {
    background-color: #0056b3;
}

#debugPanel .debug-btn-group {
    display: flex;
    gap: 5px;
}

#debugPanel .debug-close-btn {
    background: none;
    border: none;
    color: #f0f0f0;
    font-size: 24px;
    line-height: 1;
    padding: 0 5px;
    cursor: pointer;
    opacity: 0.7;
    width: auto;
    margin: 0;
}
#debugPanel .debug-close-btn:hover {
    opacity: 1;
}

#debugPanel small {
    color: #adb5bd;
    font-size: 12px;
}

/* --- Jackpot Visual Effect (REWORKED V2) --- */

/* Контейнер для анимации */
#globalGlitchOverlay.active-effect-jackpot {
    overflow: hidden;
}

/* Общий контейнер для трех вертикальных слотов */
.jackpot-slots-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 95vw; /* ИЗМЕНЕНИЕ: Увеличена ширина до 95% */
    max-width: 1200px; /* Увеличен и макс. размер */
    height: 350px; /* Немного увеличена высота видимой области */
    display: flex;
    justify-content: space-around;
    perspective: 1000px;
}

/* Один вертикальный слот */
.jackpot-slot {
    width: 32%; /* Немного подогнана ширина под 3 слота */
    height: 100%;
    overflow: hidden;
    /* ИЗМЕНЕНИЕ: Убраны border, background и box-shadow */
}

/* Лента с картинками внутри слота */
.jackpot-reel {
    position: relative;
    will-change: transform;
}

.jackpot-reel img {
    display: block;
    width: 100%;
    height: 350px; /* Высота совпадает с .jackpot-slot */
    object-fit: contain;
    padding: 5px; /* Уменьшен padding для большего размера картинки */
}

/* "Шершавая" пламенная аура */
.jackpot-aura-particle {
    position: absolute;
    background-color: #2ecc71; /* Основной зеленый цвет */
    border-radius: 50%;
    pointer-events: none;
    will-change: transform, opacity;
    mix-blend-mode: screen; 
}

/* Стили для Hybrid (Гибридная) */
.roll-slot.rarity-hybrid {
    color: #e1bee7;
    background: linear-gradient(145deg, #4a148c 0%, #311b92 100%);
    text-shadow: 0 0 8px #a7ffeb, 0 0 15px #64ffda;
    border: 1px solid #8e24aa;
    font-family: 'Orbitron', sans-serif;
}


/* Стили для Platinum (Благородная) */
.roll-slot.rarity-platinum {
    color: #263238;
    background: linear-gradient(145deg, #cfd8dc 0%, #90a4ae 100%);
    text-shadow: 0 0 10px #fff, 0 0 20px #fff;
    border: 1px solid #b0bec5;
    font-family: 'Playfair Display SC', serif;
    font-weight: bold;
}

/* Стили для Alt Error */
.roll-slot.rarity-error-alt {
    color: #ffd180; /* Светло-оранжевый текст */
    background: 
        linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)),
        repeating-conic-gradient(#ff6d00 0% 25%, #ff3d00 0% 50%);
    background-size: 20px 20px;
    text-shadow: 0 0 5px #ffab00, 0 0 10px #e65100;
    border: 1px solid #bf360c;
    font-family: 'Orbitron', sans-serif;
    animation: error-alt-bg-pan 4s linear infinite;
}
@keyframes error-alt-bg-pan {
    from { background-position: 0 0; }
    to { background-position: 20px 20px; }
}


/* --- Witchy Rarity Styles --- */

/* SVG фильтр для "жидкого" эффекта */
.svg-filters-witchy {
  position: absolute;
  visibility: hidden;
  width: 1px;
  height: 1px;
}

.roll-slot.rarity-witchy {
    color: #4a148c; /* Темно-фиолетовый текст для контраста */
    background-color: #f3e5f5; /* Очень светлый лавандовый фон */
    border: 2px solid #ab47bc;
    font-weight: bold;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
    position: relative;
    overflow: hidden;
    /* Применяем SVG фильтр */
    filter: url('#witchy-goo-filter');
}

/* Псевдоэлементы для создания "капель" */
.roll-slot.rarity-witchy::before,
.roll-slot.rarity-witchy::after {
    content: '';
    position: absolute;
    border-radius: 50%;
    background: #e1bee7; /* Более темный лавандовый */
    animation: witchy-drip 8s infinite ease-in-out;
}

.roll-slot.rarity-witchy::before {
    width: 150%;
    height: 150%;
    top: -25%;
    left: -25%;
    animation-delay: -2s;
}

.roll-slot.rarity-witchy::after {
    width: 120%;
    height: 120%;
    top: 50%;
    left: 10%;
    animation-delay: -5s;
}

@keyframes witchy-drip {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  25% { transform: translate(10px, 20px) rotate(45deg); }
  50% { transform: translate(-20px, -10px) rotate(90deg); }
  75% { transform: translate(5px, -15px) rotate(135deg); }
}



/* Alt Blackhole (Singularity) */
.roll-slot.rarity-blackhole-alt {
    color: #ffcc80;
    background: radial-gradient(ellipse at center, #212121 0%, #000000 70%);
    text-shadow: 0 0 5px #ffab00, 0 0 10px #ff6d00, 0 0 20px #e65100, 0 0 30px #dd2c00;
    border: 1px solid #ff3d00;
    font-family: 'Orbitron', sans-serif;
    animation: blackhole-orange-pulse 3s infinite alternate;
}

/* Alt Uranium (Unstable) */
.roll-slot.rarity-uranium-alt {
    color: #fff;
    background-color: #1b5e20;
    background-image: 
        repeating-linear-gradient(45deg, rgba(255,255,255,0.05) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.05) 75%, rgba(255,255,255,0.05)),
        repeating-linear-gradient(-45deg, rgba(255,255,255,0.05) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.05) 75%, rgba(255,255,255,0.05));
    background-size: 20px 20px;
    text-shadow: 0 0 10px #c8e6c9, 0 0 20px #81c784, 0 0 30px #a5d6a7;
    border: 1px solid #4caf50;
    animation: uranium-flicker 0.1s infinite;
}
@keyframes uranium-flicker {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.95; }
}

/* Alt Unbound (Unchained) */
.roll-slot.rarity-unbound-alt {
    color: #ffe0b2;
    background: linear-gradient(160deg, #f4511e, #bf360c);
    text-shadow: 0 0 5px #ffab91, 1px 1px 3px rgba(0,0,0,0.7);
    border: 1px solid #d84315;
    text-transform: uppercase;
    font-family: 'Impact', sans-serif;
    animation: fire-pulse 2s infinite ease-in-out;
}
@keyframes fire-pulse {
    from { box-shadow: inset 0 0 20px #8f230a; }
    to { box-shadow: inset 0 0 35px #d95d1e; }
}

/* Alt Space (Primordial) */
.roll-slot.rarity-space-alt {
    color: #0d47a1;
    background: linear-gradient(145deg, #e3f2fd 0%, #bbdefb 100%);
    text-shadow: 0 0 10px #fff, 0 0 20px #b3e5fc;
    border: 1px solid #90caf9;
    font-family: 'Playfair Display SC', serif;
}

/* --- New Alternative Card Styles --- */

/* Alt Common (Awakened) */
.roll-slot.rarity-common-alt {
    color: #333;
    /* Эффект "божественного" свечения с помощью нескольких градиентов */
    background: 
        radial-gradient(ellipse at center, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 60%),
        linear-gradient(135deg, #ffffff 0%, #e8e8e8 100%);
    text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    border: 1px solid #dcdcdc;
    font-weight: bold;
    animation: gentle-pulse 4s infinite ease-in-out;
}
@keyframes gentle-pulse {
    0%, 100% { box-shadow: inset 0 0 15px rgba(255,255,255,0.5); }
    50% { box-shadow: inset 0 0 25px rgba(200,200,200,0.5); }
}


/* Alt Epic (Velocity) */
.roll-slot.rarity-epic-alt {
    color: #e3f2fd;
    background-color: #1976d2;
    border: 1px solid #42a5f5;
    text-shadow: 0 0 5px #fff, 0 0 10px #82b1ff;
    position: relative;
    overflow: hidden;
}
/* Анимация "пролетающих" синих линий */
.roll-slot.rarity-epic-alt::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(130, 177, 255, 0.5), transparent);
    animation: speed-streak 1.5s linear infinite;
    animation-delay: -0.5s;
}
@keyframes speed-streak {
    0% { left: -100%; }
    100% { left: 100%; }
}


/* Alt Legendary (Deranged) */
.roll-slot.rarity-legendary-alt {
    color: #fff;
    /* Веселый, "конфетный" фон */
    background: repeating-linear-gradient(
        45deg,
        #f06292,
        #f06292 10px,
        #f8bbd0 10px,
        #f8bbd0 20px
    );
    border: 2px dashed #ad1457;
    text-shadow: 2px 2px 2px rgba(0,0,0,0.4);
    font-family: 'Comic Sans MS', cursive, sans-serif; /* Для клоунского эффекта */
    animation: crazy-shake 0.5s infinite;
}
@keyframes crazy-shake {
  0% { transform: translate(1px, 1px) rotate(0deg); }
  10% { transform: translate(-1px, -2px) rotate(-1deg); }
  20% { transform: translate(-3px, 0px) rotate(1deg); }
  30% { transform: translate(3px, 2px) rotate(0deg); }
  40% { transform: translate(1px, -1px) rotate(1deg); }
  50% { transform: translate(-1px, 2px) rotate(-1deg); }
  60% { transform: translate(-3px, 1px) rotate(0deg); }
  70% { transform: translate(3px, 1px) rotate(-1deg); }
  80% { transform: translate(-1px, -1px) rotate(1deg); }
  90% { transform: translate(1px, 2px) rotate(0deg); }
  100% { transform: translate(1px, -2px) rotate(-1deg); }
}

/* --- New Visual Effects Styles --- */

/* --- Стили для Alt Uranium (Unstable) --- */

/* --- ИСПРАВЛЕННЫЙ ЭФФЕКТ ДЛЯ АЛЬТ-УРАНОЧКИ --- */
#globalGlitchOverlay.active-effect-uranium.unstable-version::before {
    content: '';
    position: fixed;
    /* ИСПОЛЬЗУЕМ inset, чтобы привязаться к краям viewport */
    top: 0; left: 0; right: 0; bottom: 0;
    pointer-events: none;
    z-index: 9990;
    opacity: 1;
    
    /* 
    КЛЮЧЕВОЕ ИЗМЕНЕНИЕ: Используем inset box-shadow.
    Это тень, которая рисуется ВНУТРИ элемента.
    Она создаст свечение от краев экрана к центру, оставляя центр прозрачным.
    Большое значение spread (третье значение) создает широкую, мягкую границу.
    */
    box-shadow: inset 0 0 100px 50px #000, /* Глубокая черная виньетка */
                inset 0 0 60px 30px rgba(27, 94, 32, 0.8), /* Темно-зеленое свечение поверх черного */
                inset 0 0 35px 15px rgba(104, 255, 120, 0.7); /* Яркое зеленое свечение ближе к краю */

    /* Анимация пульсации и мерцания */
    animation: uranium-vignette-pulse 2s infinite alternate ease-in-out;
}

@keyframes uranium-vignette-pulse {
    from {
        /* Начальное состояние: более спокойное свечение */
        box-shadow: inset 0 0 120px 60px #000,
                    inset 0 0 70px 35px rgba(27, 94, 32, 0.7),
                    inset 0 0 40px 18px rgba(104, 255, 120, 0.6);
        opacity: 0.9;
    }
    to {
        /* Пиковое состояние: более интенсивное и сжатое свечение */
        box-shadow: inset 0 0 100px 50px #000,
                    inset 0 0 60px 30px rgba(54, 194, 63, 0.9),
                    inset 0 0 35px 15px rgba(180, 255, 190, 0.842); /* Ядро становится ярче */
        opacity: 1;
    }
}

/* 2. Witchy (Jizzy) - эффект "жидкости" */
/* SVG фильтр уже должен быть в index.html */
#globalGlitchOverlay.active-effect-witchy {
    /* Применяем фильтр ко всему оверлею */
    filter: url('#witchy-goo-filter');
    /* background-color: #d1c4e9; Светлый лавандовый фон для "капель" */
    z-index: 9998; /* Чуть ниже модалок */
}

/* "Капли", которые будут анимироваться */
.witchy-goo-blob {
    position: absolute;
    border-radius: 50%;
    /* ИЗМЕНЕНИЕ: Цвет изменен на более "органический" полупрозрачный */
    background: rgba(250, 245, 230, 0.7); /* Цвет слоновой кости/кремовый */
    will-change: transform;
    /* НОВОЕ: Тень для придания глубины */
    box-shadow: inset 0 -10px 20px rgba(0, 0, 0, 0.1);
}

/* НОВОЕ: Псевдоэлемент для создания блика */
.witchy-goo-blob::before {
    content: '';
    position: absolute;
    top: 10%;
    left: 10%;
    width: 50%;
    height: 50%;
    border-radius: 50%;
    /* Блик - это градиент от белого к прозрачному */
    background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0) 60%);
    transform: rotate(-45deg);
}


/* 3. Blackhole - эффект затягивания */
#globalGlitchOverlay.active-effect-blackhole {
    /* Пустой, будет управляться GSAP */
}

/* Стили для частиц пыли, которые затягивает дыра */
.blackhole-particle {
    position: absolute;
    width: 3px;
    height: 3px;
    background-color: #fff;
    border-radius: 50%;
    box-shadow: 0 0 8px #fff, 0 0 12px #ffab00;
}


/* 4. Cosmic (Star Elf) - переработка */
/* Старые стили для .active-effect-cosmic можно удалить */
#globalGlitchOverlay.active-effect-cosmic {
    background: radial-gradient(ellipse at center, 
        rgba(49, 27, 146, 0.1) 0%, 
        rgba(13, 71, 161, 0.2) 50%, 
        rgba(0,0,0,0.4) 100%);
}

/* Стили для звезд и туманностей */
.cosmic-star {
    position: absolute;
    background: #fff;
    border-radius: 50%;
    box-shadow: 0 0 10px #fff, 0 0 20px #bbdefb;
    animation: star-twinkle 4s infinite ease-in-out;
}
@keyframes star-twinkle {
  50% { opacity: 0.5; transform: scale(0.8); }
}

.cosmic-nebula {
    position: absolute;
    border-radius: 50%;
    mix-blend-mode: screen;
    filter: blur(40px);
    opacity: 0;
}


/* 5. Russian (Klyukva) - пьяный эффект */
/* Класс будет применяться к главному контейнеру игры */
#gameWrapper.visual-effect-russian-drunk {
    animation: drunk-sway 10s infinite ease-in-out, drunk-blur 15s infinite ease-in-out;
    /* transition нужен для плавности применения и снятия эффекта */
    transition: filter 0.5s ease, transform 0.5s ease;
}
@keyframes drunk-sway {
    0%, 100% { transform: translateX(0) rotate(0); }
    25% { transform: translateX(-1%) rotate(-1.5deg); }
    75% { transform: translateX(1%) rotate(1.5deg); }
}
@keyframes drunk-blur {
    0%, 100% { filter: blur(0) contrast(1); }
    50% { filter: blur(1.5px) contrast(1.05); }
}




/* --- Стили для новых альт-версий --- */

/* Alt Garbage (Shining Idol) */
.roll-slot.rarity-garbage-alt {
    /* Яркий, энергичный градиент, как огни сцены */
    background: linear-gradient(135deg, #ff9800 0%, #ff5722 50%, #2196f3 100%);
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    text-transform: uppercase;
    /* Тень, чтобы текст был читаемым на ярком фоне */
    text-shadow: 0 0 5px #000, 0 0 10px rgba(0,0,0,0.7);
    border: 2px solid #ffc107;
    /* Анимация переливающихся сценических огней */
    animation: idol-stage-lights 3s infinite alternate;
}

@keyframes idol-stage-lights {
    from {
        box-shadow: inset 0 0 20px #ffeb3b, 0 0 15px #2196f3;
    }
    to {
        box-shadow: inset 0 0 30px #4fc3f7, 0 0 25px #ff9800;
    }
}

/* Alt Rare (Mila, the Crimson Tear) */
.roll-slot.rarity-rare-alt {
    /* Глубокий, тревожный кроваво-красный фон */
    background: linear-gradient(160deg, #b71c1c 0%, #6a000a 70%, #000 100%);
    color: #ffcdd2; /* Бледный, болезненный красноватый текст */
    font-family: 'Georgia', 'Times New Roman', serif;
    font-style: italic;
    text-shadow: 0 0 8px #e57373, 0 0 3px #000;
    border: 1px solid #7f0000;
    /* Анимация медленной, зловещей пульсации */
    animation: crimson-madness-pulse 4s infinite ease-in-out;
}

@keyframes crimson-madness-pulse {
    0% {
        box-shadow: inset 0 0 25px rgba(0,0,0,0.8);
        letter-spacing: 0.05em;
    }
    50% {
        box-shadow: inset 0 0 40px rgba(239, 83, 80, 0.4);
        letter-spacing: 0.08em;
    }
    100% {
        box-shadow: inset 0 0 25px rgba(0,0,0,0.8);
        letter-spacing: 0.05em;
    }
}

/* --- Эффект для Berserk (Стаг) --- */
#globalGlitchOverlay.active-effect-berserk {
    /* Легкое красное свечение по всему экрану */
    box-shadow: inset 0 0 150px 50px rgba(183, 28, 28, 0.2);
}

.berserk-brand {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 250px;
    aspect-ratio: 1 / 1.5; /* <-- ДОБАВЬТЕ ЭТУ СТРОКУ (подстройте, если у картинки другие пропорции) */
    height: auto; /* эту строку можно даже удалить, aspect-ratio главнее */
    background-image: url('../img/effects/brand.png');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    filter: drop-shadow(0 0 8px rgba(255, 82, 82, 0.8)) saturate(1.5) contrast(1.2);
}

/* --- Эффект для Bee (Королева Пчёл) --- */
/* Bee: используем тайловую картинку сот вместо SVG/градиентов */
#globalGlitchOverlay.active-effect-bee {
  background-color: rgba(255, 235, 59, 0.05); /* мёдовый фон из старого варианта */
  background-image: url('img/effects/honeycomb.png'); /* твой тайл */
  background-repeat: repeat;
  background-size: 72px 72px; /* подгони под реальный тайл */
  animation: honeycomb-pan 16s linear infinite; /* очень лёгкая анимация */
}

/* Лёгкая фоновая “панорама” сот */
@keyframes honeycomb-pan {
  0%   { background-position: 0 0; }
  100% { background-position: -144px 72px; } /* смещение на два тайла по X и один по Y */
}
@keyframes bee-bg-pulse {
    from { opacity: 0.5; }
    to { opacity: 0.8; }
}

.bee-particle {
    position: absolute;
    width: 12px;
    height: 12px;
    background-color: #FFC107; /* Желтый */
    border-radius: 50% 50% 20% 20%;
    box-shadow: 0 0 5px #FFC107;
}
.bee-particle::after { /* Черные полоски */
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(-45deg, #000, #000 2px, transparent 2px, transparent 5px);
}

/* --- Эффект для Alt Gael (Velocity) - ПЕРВЫЙ ВАРИАНТ "ВЕТЕР" --- */
.velocity-line-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

.velocity-line {
    position: absolute;
    background: linear-gradient(to right, transparent, rgba(187, 222, 251, 0.7), transparent);
    height: 2px; /* Толщина линии */
}

/* --- Эффект для Alt Misa (Clownish) --- */
.confetti-particle {
    position: absolute;
    width: 10px;
    height: 10px;
}

/* Alt Berserk (Stug, at Peace) */
.roll-slot.rarity-berserk-alt {
    background: linear-gradient(145deg, #ff9800, #e65100);
    color: #fffde7;
    font-family: 'Georgia', serif;
    text-shadow: 0 0 10px #ffecb3, 0 0 5px rgba(0,0,0,0.5);
    border: 1px solid #f57c00;
    animation: campfire-flicker 3s infinite alternate ease-in-out;
}
@keyframes campfire-flicker {
    from { box-shadow: inset 0 0 20px #ffcc80; }
    to { box-shadow: inset 0 0 30px #ffe0b2; }
}

/* Alt Timestop (S.A.K.U.Y.A.) */
.roll-slot.rarity-timestop-alt {
    background: linear-gradient(160deg, #eceff1 0%, #b0bec5 70%, #78909c 100%);
    color: #263238;
    font-family: 'Times New Roman', Times, serif;
    font-style: italic;
    text-shadow: 0 0 8px #fff, 0 0 3px #81d4fa;
    border: 1px solid #90a4ae;
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-timestop-alt::before {
    content: '';
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background-image: 
        radial-gradient(circle at 10% 20%, rgba(128, 222, 234, 0.2) 1px, transparent 0),
        radial-gradient(circle at 80% 90%, rgba(207, 216, 220, 0.3) 1px, transparent 0);
    background-size: 30px 30px;
    animation: sakuya-time-shards 5s linear infinite;
}
@keyframes sakuya-time-shards {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* --- Элементарные Карты 0.1.6 --- */
.roll-slot.rarity-tungsten { background: linear-gradient(145deg, #CFD8DC, #78909c); color: #263238; border: 1px solid #90A4AE; }

.roll-slot.rarity-gold { background: linear-gradient(145deg, #FFF176, #FFD700); color: #422B00; border: 1px solid #FBC02D; animation: jackpot-pulse-glow 1.5s infinite alternate; }

.roll-slot.rarity-neon { background: #111; color: #FF1744; text-shadow: 0 0 5px #FF8A80, 0 0 10px #FF1744, 0 0 15px #D50000; border: 1px solid #FF5252; }

.roll-slot.rarity-chlorine { background: linear-gradient(45deg, #C6FF00, #8BC34A); color: #33691E; border: 1px solid #AED581; }

.roll-slot.rarity-carbon { background: #424242; color: #FAFAFA; border: 1px solid #757575; }

.roll-slot.rarity-coal { background: linear-gradient(180deg, #212121, #000); color: #FF9800; text-shadow: 0 0 8px #E65100; border: 1px solid #424242; }

.roll-slot.rarity-graphite { background: linear-gradient(160deg, #757575, #424242); color: #ECEFF1; border: 1px solid #9E9E9E; }

.roll-slot.rarity-diamond { background: radial-gradient(ellipse at center, #E0F7FA 0%, #B2EBF2 100%); color: #006064; text-shadow: 0 0 10px #fff, 0 0 20px #E0F7FA; border: 1px solid #80DEEA; }

/* Seductress (Совращающая) */
.roll-slot.rarity-seductress {
    background: linear-gradient(160deg, #4A0000 0%, #111 80%);
    color: #FFCDD2; /* Бледный розовый текст */
    font-family: 'Playfair Display SC', serif;
    text-shadow: 0 0 8px #E53935, 0 0 3px #000;
    border: 1px solid #880E4F;
}

/* Tamer (Укрощающая) */
.roll-slot.rarity-tamer {
    background: linear-gradient(135deg, #FF7043 0%, #7E57C2 100%); /* От оранжевого к фиолетовому */
    color: #FFF3E0; /* Теплый кремовый цвет текста */
    font-family: 'Quicksand', sans-serif;
    font-weight: bold;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    border: 1px solid #FFAB91;
}

/* Vacation (Отпуск) */
.roll-slot.rarity-vacation {
    background: linear-gradient(45deg, #EF5350, #FFCA28); /* От красного к солнечно-желтому */
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    text-transform: uppercase;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
    border: 1px solid rgba(255,255,255,0.5);
}

/* Alt Devil (Законтроленная) */
.roll-slot.rarity-alt-devil {
    background: linear-gradient(145deg, #d1c4e9, #9fa8da); /* Бледный, покорный градиент */
    color: #37284A; /* Темный, приглушенный текст */
    font-style: italic;
    border: 1px solid #7986cb;
    text-shadow: 1px 1px 2px rgba(255,255,255,0.3);
}

/* Librarian (Эрудированная) */
.roll-slot.rarity-librarian {
    background: linear-gradient(160deg, #78909c, #546e7a);
    color: #ECEFF1; /* Цвет старой бумаги */
    font-family: 'Georgia', serif;
    border: 1px solid #90A4AE;
}

/* Alt Librarian (Любопытная) */
.roll-slot.rarity-alt-librarian {
    background: linear-gradient(135deg, #c2185b, #880e4f);
    color: #f8bbd1;
    font-family: 'Georgia', serif;
    font-style: italic;
    text-shadow: 0 0 8px #f06292;
    border: 1px solid #ad1457;
}

/* Shroom (Грибная) */
.roll-slot.rarity-shroom {
    background: #B71C1C;
    background-image: 
        radial-gradient(circle at 10px 10px, rgba(255,255,255,0.8) 5%, transparent 6%),
        radial-gradient(circle at 40px 30px, rgba(255,255,255,0.7) 4%, transparent 5%);
    background-size: 50px 50px; /* Размер паттерна с точками */
    color: #fff;
    text-shadow: 1px 1px 3px #000;
    border: 1px solid #E53935;
}

/* Alt Shroom (Умами) */
.roll-slot.rarity-alt-shroom {
    background: linear-gradient(145deg, #A1887F, #6D4C41);
    color: #EFEBE9;
    font-family: 'Quicksand', sans-serif;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    border: 1px solid #8D6E63;
}

.upgrade-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
    font-size: 1.1em;
    font-family: 'Orbitron', sans-serif;
    animation: text-fade-in 0.5s 0.6s ease-out forwards;
    opacity: 0;
}
.upgrade-indicator .arrow {
    font-weight: bold;
}
.multi-roll-slot-wrapper {
    position: relative; /* Необходимо для позиционирования индикатора */
    display: flex;
    flex-direction: column; /* Располагаем индикатор и слот друг под другом */
    justify-content: center;
    align-items: center;
}

.slot-upgrade-indicator {
    /* position: absolute; */ /* Убрал абсолютное, чтобы он сдвигал слот вниз */
    /* top: -20px; */ /* Больше не нужно */
    width: 100%;
    text-align: center;
    color: #ffc107; /* Яркий желтый/золотой */
    font-size: 0.8em;
    font-weight: bold;
    text-shadow: 1px 1px 1px #000;
    margin-bottom: 2px; /* Небольшой отступ от слота */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.slot-upgrade-indicator .arrow {
    color: #fff;
    margin: 0 4px;
}
.slot-upgrade-indicator.jackpot-indicator {
    color: #ffd700; /* Яркий золотой цвет */
    text-shadow: 0 0 5px #ffab00, 1px 1px 1px #000;
    animation: jackpot-pulse-glow 1s infinite alternate; /* Добавим пульсацию от другого эффекта */
}

/* Rias (Алая) */
.roll-slot.rarity-rias {
    background: linear-gradient(145deg, #d32f2f 0%, #7f0000 100%);
    color: #ffcdd2;
    font-family: 'Playfair Display SC', serif;
    font-weight: bold;
    text-shadow: 0 0 8px #ef5350, 1px 1px 2px #000;
    border: 1px solid #c62828;
}

/* Amy (Нежная) */
.roll-slot.rarity-amy {
    background: linear-gradient(135deg, #9575CD, #673AB7);
    color: #EDE7F6;
    font-family: 'Quicksand', sans-serif;
    border: 1px solid #7E57C2;
}

/* Raven (Страстная) */
.roll-slot.rarity-raven {
    background: linear-gradient(160deg, #4527A0, #1A237E);
    color: #D1C4E9;
    font-family: 'Georgia', serif;
    font-style: italic;
    text-shadow: 0 0 10px #B39DDB;
    border: 1px solid #512DA8;
}

/* --- Стили для карт из "Плана" (Версия 2.0) --- */

/* Вечная (Ананке Хрона) */
.roll-slot.rarity-time-eternal {
    background: #000;
    color: #FFD700;
    border: 1px solid #444;
    text-shadow: 0 0 10px #FFD700, 0 0 5px #FFD700;
    font-family: 'Cinzel Decorative', cursive;
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-time-eternal::before {
    content: '';
    position: absolute;
    width: 200%; height: 200%;
    top: -50%; left: -50%;
    background-image:
        radial-gradient(circle, rgba(255, 215, 0, 0.2) 1px, transparent 1px),
        radial-gradient(circle, rgba(158, 158, 158, 0.1) 1px, transparent 1px);
    background-size: 30px 30px, 45px 45px;
    animation: eternal-spin 60s linear infinite;
}
@keyframes eternal-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* Светлая Принцесса (София) */
.roll-slot.rarity-shy-princess {
    background: linear-gradient(145deg, #F3E5F5, #D1C4E9);
    color: #6A1B9A;
    border: 1px solid #B39DDB;
    text-shadow: 0 0 5px rgba(255,255,255,0.7);
}

/* Тёмная Принцесса (Рокси) */
.roll-slot.rarity-dark-princess {
    background: linear-gradient(135deg, #1a1a1a 0%, #311b92 100%);
    color: #F8BBD0;
    font-family: 'Orbitron', sans-serif;
    border: 1px solid #F48FB1;
    text-shadow: 0 0 8px #F06292;
}

/* Отсутствовавшая (Аластор) */
.roll-slot.rarity-alastor {
    background: #500000;
    color: #ffcdd2;
    border: 1px solid #c62828;
    position: relative;
    overflow: hidden;
    font-family: 'Playfair Display SC', serif;
}
.roll-slot.rarity-alastor::after {
    content: '';
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    background: repeating-radial-gradient(circle, rgba(255,0,0,0.2) 0, transparent 5px, transparent 40px);
    animation: radio-pulse 3s linear infinite;
}
@keyframes radio-pulse { from { transform: scale(0); opacity: 1; } to { transform: scale(1.5); opacity: 0; } }

/* Материнская (Туториэль) */
.roll-slot.rarity-maternal {
    background: linear-gradient(145deg, #BF360C, #F57C00);
    color: #FFF3E0;
    border: 1px solid #FFAB91;
    font-family: 'Georgia', serif;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
}

/* Хэви (Кори Беннингтон) */
.roll-slot.rarity-metalhead {
    background: #111;
    color: #fff;
    border: 2px solid #fff;
    border-image: linear-gradient(45deg, #fff, #9e9e9e, #fff) 1;
    font-family: 'Impact', sans-serif;
    text-transform: uppercase;
    text-shadow: 0 0 10px #fff;
}

/* Лунная (Селена) */
.roll-slot.rarity-moon {
    background: linear-gradient(180deg, #000, #263238, #546E7A);
    color: #ECEFF1;
    border: 1px solid #90A4AE;
    text-shadow: 0 0 15px #fff, 0 0 5px #fff;
}

/* Чинящая (Женя) */
.roll-slot.rarity-mechanic {
    background: #333;
    background-image: 
        repeating-linear-gradient(45deg, #222 25%, transparent 25%, transparent 75%, #222 75%, #222), 
        repeating-linear-gradient(-45deg, #222 25%, transparent 25%, transparent 75%, #222 75%, #222);
    background-size: 30px 30px;
    color: #4CAF50;
    text-shadow: 0 0 8px #81C784, 0 0 3px #000;
    border: 1px solid #4CAF50;
}

/* Излечивающая (Тина) */
.roll-slot.rarity-doctor {
    background: #FCE4EC;
    color: #D81B60;
    border: 1px solid #F48FB1;
    position: relative;
    font-weight: bold;
}
.roll-slot.rarity-doctor::before {
    content: '❤';
    position: absolute;
    top: 5px; left: 10px;
    font-size: 0.8em;
    opacity: 0.3;
}
.roll-slot.rarity-doctor::after {
    content: '❤';
    position: absolute;
    bottom: 5px; right: 10px;
    font-size: 0.8em;
    opacity: 0.3;
}

/* Шёлковая (Хана Акано) */
.roll-slot.rarity-silken {
    background: #C2185B;
    color: #fff;
    border: 1px solid #F48FB1;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M22 83c10-21 34-31 51-24 16 6 23 25 14 41-10 18-32 23-48 15s-23-26-17-42z" fill="rgba(255,255,255,0.03)"/></svg>');
    background-size: 60px;
}

/* Пленённая (Эльфийка в ловушке) */
.roll-slot.rarity-ensnared {
    background: #4E342E;
    color: #BCAAA4;
    border: 2px solid #A1887F;
    font-style: italic;
    background-image:
      linear-gradient(rgba(0, 0, 0, .3), rgba(0, 0, 0, .3)),
      linear-gradient(90deg, #6D4C41 1px, transparent 1px),
      linear-gradient(#6D4C41 1px, transparent 1px);
    background-size: 100% 100%, 20px 20px, 20px 20px;
}

/* Провожающая (Таинственная эльфийка) */
.roll-slot.rarity-guide {
    background: #CFD8DC;
    color: #263238;
    border: 1px solid #B0BEC5;
    font-family: 'Times New Roman', serif;
}

/* --- Стили для системы тем --- */

/* --- НАЧАЛО: НОВАЯ ТЕМА 'КЛАССИКА' (АЛАЯ/ГОТИЧЕСКАЯ) --- */
html.theme-classic {
    --theme-bg: #2a1a1d; /* Очень темный, десатурированный бордовый */
    --theme-container-bg: #3a2a2d; /* Чуть светлее для контейнеров */
    --theme-text: #e0d8d8; /* Теплый, не чисто белый текст */
    --theme-accent: #b71c1c; /* Насыщенный алый для акцентов (как у "Русской" редкости) */
    --theme-accent-hover: #d32f2f; /* Ярче при наведении */
    --theme-border: #4a2a2d; /* Темная граница */
}

/* Применяем основные цвета */
.theme-classic body {
    background-color: var(--theme-bg);
    color: var(--theme-text);
}

/* Узор на фоне с помощью псевдоэлемента */
.theme-classic body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    /* Встроенный SVG с орнаментом. Цвет очень тусклый, чтобы не мешать. */
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><path d="M50,0 C20,20 20,80 50,100 C80,80 80,20 50,0 M0,50 C20,20 80,20 100,50 C80,80 20,80 0,50" fill="none" stroke="rgba(183, 28, 44, 0.05)" stroke-width="2"/></svg>');
    background-size: 200px 200px;
    opacity: 0.5;
    z-index: -1; /* Помещаем под всем контентом */
    pointer-events: none;
}

.theme-classic h1, .theme-classic h2, .theme-classic h3, .theme-classic h4, .theme-classic h5, .theme-classic h6 {
    color: var(--theme-text);
    text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
}

.theme-classic .text-muted {
    color: #9e8a8e !important;
}

/* Кнопки */
.theme-classic .btn-primary {
    background-color: var(--theme-accent);
    border-color: #8e0000;
    box-shadow: 0 0 8px var(--theme-accent), inset 0 0 5px rgba(255,255,255,0.2);
}
.theme-classic .btn-primary:hover {
    background-color: var(--theme-accent-hover);
    border-color: var(--theme-accent);
}

/* Вкладки */
.theme-classic .nav-tabs {
    border-bottom-color: var(--theme-border);
}
.theme-classic .nav-tabs .nav-link {
    color: #b0a0a4;
    border-bottom-color: var(--theme-border);
}
.theme-classic .nav-tabs .nav-link.active {
    color: var(--theme-text);
    background-color: var(--theme-container-bg);
    border-color: var(--theme-border) var(--theme-border) var(--theme-container-bg);
    box-shadow: none;
}

/* Контент вкладок и списки */
.theme-classic .tab-content {
    background-color: var(--theme-container-bg);
    border-color: var(--theme-border);
    box-shadow: 0 5px 15px rgba(0,0,0,0.4);
}
.theme-classic .list-group-item {
    background-color: #4a3a3d;
    border-color: var(--theme-border);
}
.theme-classic .list-group-item strong {
    color: var(--theme-text);
}

/* Карточки в инвентаре */
.theme-classic .inventory-card {
    background-color: var(--theme-container-bg);
    border-color: var(--theme-border);
}
.theme-classic .inventory-card.locked {
    background-color: var(--theme-bg);
    border-color: var(--theme-border);
}
.theme-classic .inventory-card.locked .inventory-card-name {
    color: #9e8a8e;
}
.theme-classic .inventory-card:hover {
    box-shadow: 0 8px 16px rgba(0,0,0,0.5), 0 0 15px var(--rarity-glow-color, #777);
}

/* Анимация ролла */
.theme-classic .roll-animation-container {
    background-color: #1a0a0d;
    border-color: var(--theme-border);
    box-shadow: inset 0 0 15px rgba(0,0,0,0.7);
}
.theme-classic .roll-slot {
    text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
}

/* Специальные контейнеры */
.theme-classic .card.bg-dark-subtle {
    background-color: var(--theme-container-bg) !important;
}

/* Совместимость со старыми темами Bootstrap, если где-то остались */
.theme-classic {
    color-scheme: dark;
}
.theme-classic .btn-close-white {
    filter: none;
}
/* --- КОНЕЦ: НОВАЯ ТЕМА 'КЛАССИКА' (АЛАЯ/ГОТИЧЕСКАЯ) --- */

/* ==========================
   THEME CLASSIC — v2 (depth + buttons)
   ========================== */

/* Контейнеры/фон/заголовки чуть глубже */
.theme-classic body {
  background:
    radial-gradient(ellipse at 20% 10%, rgba(183,28,28,0.06), transparent 55%),
    radial-gradient(ellipse at 80% 90%, rgba(183,28,28,0.04), transparent 60%),
    linear-gradient(135deg, #2a1a1d, #3a2a2d 60%, #2a1a1d);
}
.theme-classic .tab-content,
.theme-classic .list-group-item,
.theme-classic .card.bg-dark-subtle {
  background-color: var(--theme-container-bg) !important;
  border-color: var(--theme-border) !important;
  box-shadow: 0 0 0 1px rgba(0,0,0,0.12), 0 10px 22px rgba(0,0,0,0.45);
}
.theme-classic h1, .theme-classic h2, .theme-classic h3, .theme-classic h4 {
  text-shadow: 0 0 6px rgba(183,28,28,0.2);
}

/* Табы */
.theme-classic .nav-tabs { border-bottom-color: var(--theme-border); }
.theme-classic .nav-tabs .nav-link {
  color: #b0a0a4;
  border-bottom-color: var(--theme-border);
  background: transparent;
}
.theme-classic .nav-tabs .nav-link.active {
  color: var(--theme-text);
  background-color: var(--theme-container-bg);
  border-color: var(--theme-border) var(--theme-border) var(--theme-container-bg);
  position: relative;
}
.theme-classic .nav-tabs .nav-link.active::after {
  content: '';
  position: absolute; left: 0; right: 0; bottom: -1px; height: 3px;
  background: linear-gradient(90deg, transparent, var(--theme-accent), transparent);
}

/* Полный пакет кнопок (как у Choco, но в алых тонах) */
.theme-classic .btn {
  border-radius: 12px;
  border: 1px solid var(--theme-border);
  color: var(--theme-text);
  text-shadow: 0 1px 0 rgba(0,0,0,0.35);
  transition: transform .05s ease-out, box-shadow .15s ease, background .15s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.06);
}
.theme-classic .btn:active { transform: translateY(1px) scale(0.995); }
.theme-classic .btn:focus-visible {
  outline: 2px solid var(--theme-accent-hover);
  outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(211,47,47,0.25);
}

/* primary — алый */
.theme-classic .btn-primary {
  background: linear-gradient(145deg, #b71c1c, #8e0000);
  border-color: #700000;
  color: #ffeaea;
}
.theme-classic .btn-primary:hover {
  background: linear-gradient(145deg, #d32f2f, #9e0d0d);
}

/* info — приглушённый бордовый */
.theme-classic .btn-info {
  background: linear-gradient(145deg, #8b2525, #6b1b1b);
  border-color: #531515;
  color: #ffeaea;
}
.theme-classic .btn-info:hover { background: linear-gradient(145deg, #a62c2c, #7a2020); }

/* success — тёплый графит */
.theme-classic .btn-success {
  background: linear-gradient(145deg, #5a5a64, #3f3f48);
  border-color: #2f2f36;
  color: #f0f0f0;
}
.theme-classic .btn-success:hover { background: linear-gradient(145deg, #6b6b76, #4b4b54); }

/* danger — винный */
.theme-classic .btn-danger {
  background: linear-gradient(145deg, #a22626, #7a1d1d);
  border-color: #5c1515; color: #ffeaea;
}
.theme-classic .btn-danger:hover { background: linear-gradient(145deg, #bb2e2e, #8e2323); }

/* secondary */
.theme-classic .btn-secondary {
  background: linear-gradient(145deg, #3f2c30, #2b1d20);
  border-color: var(--theme-border);
  color: var(--theme-text);
}
.theme-classic .btn-secondary:hover { background: linear-gradient(145deg, #4a3439, #342327); }

/* outline */
.theme-classic .btn-outline-primary {
  color: #ffeaea; border-color: #8e0000;
}
.theme-classic .btn-outline-primary:hover {
  background: linear-gradient(145deg, #b71c1c, #8e0000);
  color: #ffeaea;
}
.theme-classic .btn-outline-secondary { color: var(--theme-text); border-color: var(--theme-border); }
.theme-classic .btn-outline-secondary:hover { background: linear-gradient(145deg, #3f2c30, #2b1d20); }

/* Бейджи (зачистка Bootstrap-синих) */
.theme-classic .badge { border: 1px solid rgba(0,0,0,0.18); }
.theme-classic .badge.bg-primary {
  background: linear-gradient(145deg, #b71c1c, #8e0000);
  color: #ffeaea; border-color: #700000;
}
.theme-classic .badge.bg-info {
  background: linear-gradient(145deg, #8b2525, #6b1b1b);
  color: #ffeaea; border-color: #531515;
}
.theme-classic .badge.bg-success {
  background: linear-gradient(145deg, #5a5a64, #3f3f48); color: #f0f0f0; border-color: #2f2f36;
}
.theme-classic .badge.bg-danger {
  background: linear-gradient(145deg, #a22626, #7a1d1d); color: #ffeaea; border-color: #5c1515;
}

/* Модалки и баннер */
.theme-classic .modal-content {
  background: linear-gradient(145deg, #2e1e21, #3a262a 60%, #2a1a1d);
  border: 1px solid var(--theme-border);
  box-shadow: 0 0 0 1px rgba(0,0,0,0.2), 0 20px 40px rgba(0,0,0,0.55);
}
.theme-classic .alert { background: linear-gradient(145deg, #2e1e21, #3a262a); border-color: var(--theme-border); color: var(--theme-text); }

/* Глобальный эффект RGB-ленты */
#globalGlitchOverlay.active-effect-neon .neon-border-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}
.neon-tube {
    position: absolute;
    background-color: #fff; /* Основа для свечения */
    box-shadow:
        0 0 5px #fff,
        0 0 10px #fff,
        0 0 20px #ff00ff, /* Цвет свечения будет меняться анимацией */
        0 0 30px #ff00ff,
        0 0 40px #ff00ff;
    animation: neon-rgb-hue-rotate 5s linear infinite;
}
.neon-tube-top { top: 0; left: 0; width: 100%; height: 4px; }
.neon-tube-right { top: 0; right: 0; width: 4px; height: 100%; }
.neon-tube-bottom { bottom: 0; left: 0; width: 100%; height: 4px; }
.neon-tube-left { top: 0; left: 0; width: 4px; height: 100%; }

@keyframes neon-rgb-hue-rotate {
    to {
        filter: hue-rotate(360deg);
    }
}

/* Глобальный эффект цепей */
#globalGlitchOverlay.active-effect-devil {
    box-shadow: inset 0 0 200px 80px rgba(100, 0, 0, 0.25);
}
.devil-chain-container {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    overflow: visible; /* Чтобы цепи не обрезались краями SVG */
}
.devil-chain-link {
    fill: none;
    stroke: #333; /* Темный металлический цвет */
    stroke-width: 4;
    stroke-linecap: round;
    filter: drop-shadow(0 0 3px rgba(255, 100, 100, 0.5));
}

/* Гал (Создательница) */
.roll-slot.rarity-gal {
    background: #000;
    color: #f0f0f0;
    border: 2px solid #fff;
    text-shadow: 0 0 10px #fff, 0 0 20px #ccc;
    font-family: 'Cinzel Decorative', cursive;
    font-weight: bold;
}

/* Натрий (Кристальная) */
.roll-slot.rarity-sodium {
    background: linear-gradient(145deg, #f8f8ff, #e8e6f5);
    color: #4A148C;
    border: 1px solid #d1c4e9;
    text-shadow: 0 0 8px rgba(255,255,255,0.8);
}

/* Обсидиан (Остывшая) */
.roll-slot.rarity-obsidian {
    background: #212121;
    color: #FFCDD2;
    border: 1px solid #424242;
    text-shadow: 0 0 8px #E53935;
}

/* Лава (Расплавленная) */
.roll-slot.rarity-lava {
    background: linear-gradient(160deg, #F57C00, #D84315);
    color: #FFF3E0;
    border: 1px solid #E64A19;
    text-shadow: 0 0 10px #FFCC80, 1px 1px 2px #000;
    animation: fire-pulse 2.5s infinite ease-in-out;
}

/* Гоблин Альт (Удовлетворённая) */
.roll-slot.rarity-goblin-alt {
    background: linear-gradient(135deg, #8BC34A, #558B2F);
    color: #F1F8E9;
    border: 1px solid #9CCC65;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

/* Соль (Солёная) */
.roll-slot.rarity-salt {
    background: #FAFAFA;
    color: #616161;
    border: 2px solid #E0E0E0;
    font-weight: bold;
}

html.theme-salt {
    --theme-bg: #e9ecef; /* Очень светлый серый фон */
    --theme-container-bg: #f8f9fa; /* Почти белый для контейнеров */
    --theme-text: #495057; /* Темно-серый текст */
    --theme-accent: #6c757d; /* Приглушенный акцентный цвет */
    --theme-accent-hover: #5a6268;
    --theme-border: #dee2e6;
    color-scheme: light; /* Важно, чтобы браузер использовал светлые контролы */
}

.theme-salt body {
    background-color: var(--theme-bg);
    color: var(--theme-text);
}
.theme-salt h1, .theme-salt h2, .theme-salt h3, .theme-salt h4, .theme-salt h5, .theme-salt h6 {
    color: #212529; /* Почти черный для заголовков */
}
.theme-salt .text-muted { color: #868e96 !important; }
.theme-salt .btn-primary { background-color: var(--theme-accent); border-color: var(--theme-accent); box-shadow: none; }
.theme-salt .btn-primary:hover { background-color: var(--theme-accent-hover); border-color: var(--theme-accent-hover); }
.theme-salt .btn-close-white { filter: invert(1) grayscale(100%) brightness(0%); }
.theme-salt .nav-tabs .nav-link { color: var(--theme-text); border-bottom-color: var(--theme-border); }
.theme-salt .nav-tabs .nav-link.active { color: #000; background-color: var(--theme-container-bg); border-color: var(--theme-border) var(--theme-border) var(--theme-container-bg); }
.theme-salt .tab-content { background-color: var(--theme-container-bg); border-color: var(--theme-border); }
.theme-salt .list-group-item { background-color: #fff; border-color: var(--theme-border); }
.theme-salt .inventory-card, .theme-salt .roll-animation-container { background-color: #e9ecef; border-color: var(--theme-border); }

/* ==========================
   THEME SALT — v2 (mineral light, prism accent)
   ========================== */

html.theme-salt {
  --salt-bg-1: #eef3f7;      /* мягкий светлый фон */
  --salt-bg-2: #e6edf4;
  --salt-tile: #f6f9fb;
  --salt-text: #2f4152;      /* тёмно‑синий графит */
  --salt-muted: #5c6f83;

  --salt-accent: #8cc7ff;    /* призматический голубой */
  --salt-accent-2: #a8d6ff;
  --salt-border: #cfd9e3;

  color-scheme: light;
}

/* Фон с лёгкой “призмой” (очень деликатно) */
.theme-salt body {
  background:
    linear-gradient(90deg, rgba(255,255,255,0.6) 1px, transparent 1px) 0 0 / 26px 26px,
    linear-gradient( 0deg, rgba(255,255,255,0.6) 1px, transparent 1px) 0 0 / 26px 26px,
    radial-gradient(circle at 12% 10%, rgba(140,199,255,0.08), transparent 35%),
    radial-gradient(circle at 84% 88%, rgba(168,214,255,0.08), transparent 35%),
    linear-gradient(135deg, var(--salt-bg-1), var(--salt-bg-2) 60%, #e9f0f6);
  color: var(--salt-text);
}

/* Контейнеры */
.theme-salt .tab-content,
.theme-salt .list-group-item,
.theme-salt .card.bg-dark-subtle {
  background: var(--salt-tile) !important;
  border-color: var(--salt-border) !important;
  box-shadow: 0 1px 0 rgba(255,255,255,0.9) inset, 0 10px 24px rgba(0,30,60,0.08);
}

/* Заголовки */
.theme-salt h1,.theme-salt h2,.theme-salt h3,.theme-salt h4 {
  color: var(--salt-text);
  text-shadow: 0 0 6px rgba(140,199,255,0.12);
}

/* Табы */
.theme-salt .nav-tabs { border-bottom-color: var(--salt-border); }
.theme-salt .nav-tabs .nav-link {
  color: var(--salt-muted);
  border-bottom-color: var(--salt-border);
  background: transparent;
}
.theme-salt .nav-tabs .nav-link.active {
  color: var(--salt-text);
  background-color: var(--salt-tile);
  border-color: var(--salt-border) var(--salt-border) var(--salt-tile);
  position: relative;
}
.theme-salt .nav-tabs .nav-link.active::after {
  content: ''; position: absolute; left:0; right:0; bottom:-1px; height:3px;
  background: linear-gradient(90deg, transparent, var(--salt-accent), transparent);
  box-shadow: 0 0 8px rgba(140,199,255,0.35);
}

/* Кнопки — в основном серые/графитовые, с лёгким голубым отблеском */
.theme-salt .btn {
  border-radius: 12px;
  border: 1px solid var(--salt-border);
  color: var(--salt-text);
  text-shadow: 0 1px 0 rgba(255,255,255,0.6);
  transition: transform .05s, box-shadow .15s, background .15s, color .15s;
  box-shadow: 0 2px 6px rgba(0,30,60,0.08), inset 0 1px 0 rgba(255,255,255,0.75);
}
.theme-salt .btn:active { transform: translateY(1px) scale(0.995); }
.theme-salt .btn:focus-visible {
  outline: 2px solid var(--salt-accent-2); outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(140,199,255,0.25);
}

/* primary — прохладный серо‑голубой */
.theme-salt .btn-primary {
  background: linear-gradient(145deg, #aebdca, #8ea1b4);
  border-color: #7b8fa3; color: #0f2134;
}
.theme-salt .btn-primary:hover { background: linear-gradient(145deg, #c3cfda, #9fb0c1); }

/* info — стальной серый */
.theme-salt .btn-info {
  background: linear-gradient(145deg, #9aa9b8, #7f92a5);
  border-color: #6c7f92; color: #102234;
}
.theme-salt .btn-info:hover { background: linear-gradient(145deg, #b4c2d1, #93a6b8); }

/* success — приглушённый мятный */
.theme-salt .btn-success {
  background: linear-gradient(145deg, #a7d6c2, #86baa5);
  border-color: #6aa08c; color: #0f1f1a;
}
.theme-salt .btn-success:hover { background: linear-gradient(145deg, #bde3d0, #9acbb9); }

/* danger — мягкий терракотовый (без «ядра» красного) */
.theme-salt .btn-danger {
  background: linear-gradient(145deg, #d4a1a1, #b68181);
  border-color: #9a6a6a; color: #2a0f0f;
}
.theme-salt .btn-danger:hover { background: linear-gradient(145deg, #e2b7b7, #c59393); }

/* secondary — графит */
.theme-salt .btn-secondary {
  background: linear-gradient(145deg, #cfd9e3, #b7c4d1);
  border-color: var(--salt-border); color: #1f2f3f;
}
.theme-salt .btn-secondary:hover { background: linear-gradient(145deg, #dde5ec, #c8d4df); }

/* outline */
.theme-salt .btn-outline-primary { color: #1f2f3f; border-color: #8ea1b4; }
.theme-salt .btn-outline-primary:hover {
  background: linear-gradient(145deg, #aebdca, #8ea1b4); color: #0f2134;
}
.theme-salt .btn-outline-secondary { color: var(--salt-text); border-color: var(--salt-border); }
.theme-salt .btn-outline-secondary:hover { background: linear-gradient(145deg, #cfd9e3, #b7c4d1); }

/* Бейджи (без bootstrap‑синих) */
.theme-salt .badge { border: 1px solid rgba(0,30,60,0.12); }
.theme-salt .badge.bg-primary {
  background: linear-gradient(145deg, #aebdca, #8ea1b4);
  color: #0f2134; border-color: #7b8fa3;
}
.theme-salt .badge.bg-info {
  background: linear-gradient(145deg, #9aa9b8, #7f92a5);
  color: #102234; border-color: #6c7f92;
}
.theme-salt .badge.bg-success {
  background: linear-gradient(145deg, #a7d6c2, #86baa5);
  color: #0f1f1a; border-color: #6aa08c;
}
.theme-salt .badge.bg-danger {
  background: linear-gradient(145deg, #d4a1a1, #b68181);
  color: #2a0f0f; border-color: #9a6a6a;
}

/* Модалки/баннер */
.theme-salt .modal-content {
  background: linear-gradient(145deg, #f5f8fb, #eaf1f7 60%, #f3f7fb);
  border: 1px solid var(--salt-border);
  box-shadow: 0 0 0 1px rgba(140,199,255,0.12), 0 14px 28px rgba(0,30,60,0.12);
}
.theme-salt .alert {
  background: linear-gradient(145deg, #f3f7fb, #e9f1f8);
  border-color: var(--salt-border);
  color: var(--salt-text);
}

/* Инвентарь */
.theme-salt .inventory-card {
  background:
    radial-gradient(circle at 12% 18%, rgba(255,255,255,0.65), transparent 36%),
    radial-gradient(circle at 84% 86%, rgba(255,255,255,0.55), transparent 30%),
    linear-gradient(135deg, #f7fafc, #eef4f9 60%, #f2f7fb);
  border-color: var(--salt-border);
}
.theme-salt .inventory-card-name { background: rgba(15,33,52,0.55); color: #f2f6fa; }

/* Achievements — читабельность состояний */
.theme-salt #achievements .list-group-item { transition: background .15s ease, box-shadow .15s ease; }
/* выполнено */
.theme-salt #achievements .list-group-item.bg-success-subtle {
  background: linear-gradient(145deg, #eef5fb, #e4edf5);
  border-color: var(--salt-border) !important;
  border-left: 4px solid var(--salt-accent);
  box-shadow: 0 0 0 1px rgba(140,199,255,0.18), 0 8px 16px rgba(0,30,60,0.12);
}
.theme-salt #achievements .list-group-item.bg-success-subtle strong { color: #3b6f99; }
.theme-salt #achievements .list-group-item.bg-success-subtle small  { color: #3b4f61; }
/* не выполнено */
.theme-salt #achievements .list-group-item.bg-dark-subtle {
  background: linear-gradient(145deg, #e9f0f6, #e3eaf1);
  border-color: var(--salt-border) !important;
  border-left: 4px solid rgba(140,199,255,0.25);
}
.theme-salt #achievements .list-group-item.bg-dark-subtle strong { color: var(--salt-text); opacity: .85; }
.theme-salt #achievements .list-group-item.bg-dark-subtle small  { color: var(--salt-muted); opacity: .9; }

/* --- Тема 'Престиж' (Черно-золотая) --- */
html.theme-prestige {
    --theme-bg: #121212; /* Глубокий черный */
    --theme-container-bg: #1d1d1d;
    --theme-text: #e0e0e0;
    --theme-accent: #ffd700; /* Золотой */
    --theme-accent-hover: #ffec8b;
    --theme-border: #424242;
    color-scheme: dark;
}

.theme-prestige body { background-color: var(--theme-bg); color: var(--theme-text); }
.theme-prestige h1, .theme-prestige h2, .theme-prestige h3, .theme-prestige h4 { color: var(--theme-accent); text-shadow: 0 0 5px rgba(255, 215, 0, 0.3); }
.theme-prestige .text-muted { color: #757575 !important; }
.theme-prestige .btn-primary { background-color: transparent; border-color: var(--theme-accent); color: var(--theme-accent); box-shadow: 0 0 5px var(--theme-accent); }
.theme-prestige .btn-primary:hover { background-color: var(--theme-accent); border-color: var(--theme-accent); color: #000; box-shadow: 0 0 10px var(--theme-accent); }
.theme-prestige .nav-tabs { border-bottom-color: var(--theme-border); }
.theme-prestige .nav-tabs .nav-link { color: #9e9e9e; border-bottom-color: var(--theme-border); }
.theme-prestige .nav-tabs .nav-link.active { color: var(--theme-accent); background-color: var(--theme-container-bg); border-color: var(--theme-border) var(--theme-border) var(--theme-container-bg); }
.theme-prestige .tab-content, .theme-prestige .list-group-item { background-color: var(--theme-container-bg); border-color: var(--theme-border); }
.theme-prestige .inventory-card.border-gold, .theme-prestige .inventory-card.border-legendary { box-shadow: 0 0 15px var(--rarity-glow-color); }

/* ==========================
   THEME PRESTIGE — v2 (deep black & gold, full buttons)
   ========================== */

.theme-prestige body {
  background:
    radial-gradient(ellipse at 20% 10%, rgba(255,215,0,0.08), transparent 55%),
    radial-gradient(ellipse at 82% 88%, rgba(255,215,0,0.06), transparent 50%),
    linear-gradient(135deg, #0e0e0e, #141414 60%, #0f0f0f);
  color: var(--theme-text);
}
.theme-prestige h1,.theme-prestige h2,.theme-prestige h3,.theme-prestige h4 {
  text-shadow: 0 0 7px rgba(255,215,0,0.18);
}

/* Контейнеры */
.theme-prestige .tab-content,
.theme-prestige .list-group-item,
.theme-prestige .card.bg-dark-subtle {
  background-color: var(--theme-container-bg) !important;
  border-color: var(--theme-border) !important;
  box-shadow: 0 0 0 1px rgba(255,215,0,0.08), 0 14px 28px rgba(0,0,0,0.55);
}

/* Табы */
.theme-prestige .nav-tabs { border-bottom-color: var(--theme-border); }
.theme-prestige .nav-tabs .nav-link {
  color: #bdbdbd;
  border-bottom-color: var(--theme-border);
  background: transparent;
}
.theme-prestige .nav-tabs .nav-link.active {
  color: var(--theme-accent);
  background-color: var(--theme-container-bg);
  border-color: var(--theme-border) var(--theme-border) var(--theme-container-bg);
  position: relative;
}
.theme-prestige .nav-tabs .nav-link.active::after {
  content: ''; position: absolute; left:0; right:0; bottom:-1px; height: 3px;
  background: linear-gradient(90deg, transparent, var(--theme-accent), transparent);
  box-shadow: 0 0 8px rgba(255,215,0,0.35);
}

/* Кнопки — полный пакет */
.theme-prestige .btn {
  border-radius: 12px;
  border: 1px solid var(--theme-border);
  color: var(--theme-text);
  text-shadow: 0 1px 0 rgba(0,0,0,0.4);
  transition: transform .05s, box-shadow .15s, background .15s;
  box-shadow: 0 3px 10px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.05);
}
.theme-prestige .btn:active { transform: translateY(1px) scale(0.995); }
.theme-prestige .btn:focus-visible {
  outline: 2px solid var(--theme-accent); outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(255,215,0,0.25);
}

/* primary — золото */
.theme-prestige .btn-primary {
  background: linear-gradient(145deg, #ffd700, #caa20c);
  border-color: #9a7d0a; color: #101010;
}
.theme-prestige .btn-primary:hover { background: linear-gradient(145deg, #ffec8b, #e1c759); }

/* info — платиновый серый */
.theme-prestige .btn-info {
  background: linear-gradient(145deg, #6b6b76, #4b4b54);
  border-color: #3b3b42; color: #f2f2f2;
}
.theme-prestige .btn-info:hover { background: linear-gradient(145deg, #808090, #5a5a66); }

/* success — благородный зелёный */
.theme-prestige .btn-success {
  background: linear-gradient(145deg, #67b26f, #4e8f57);
  border-color: #3b6b41; color: #0f1511;
}
.theme-prestige .btn-success:hover { background: linear-gradient(145deg, #7bd183, #5ca165); }

/* danger — гранатовый */
.theme-prestige .btn-danger {
  background: linear-gradient(145deg, #b24545, #872f2f);
  border-color: #5f2121; color: #ffeaea;
}
.theme-prestige .btn-danger:hover { background: linear-gradient(145deg, #c55555, #953737); }

/* secondary */
.theme-prestige .btn-secondary {
  background: linear-gradient(145deg, #252525, #191919);
  border-color: var(--theme-border); color: var(--theme-text);
}
.theme-prestige .btn-secondary:hover { background: linear-gradient(145deg, #2e2e2e, #202020); }

/* outline-варианты */
.theme-prestige .btn-outline-primary { color: var(--theme-accent); border-color: var(--theme-accent); }
.theme-prestige .btn-outline-primary:hover {
  background: linear-gradient(145deg, #ffd700, #caa20c); color: #101010;
}
.theme-prestige .btn-outline-secondary { color: var(--theme-text); border-color: var(--theme-border); }
.theme-prestige .btn-outline-secondary:hover { background: linear-gradient(145deg, #252525, #191919); }

/* Бейджи */
.theme-prestige .badge { border: 1px solid rgba(0,0,0,0.25); }
.theme-prestige .badge.bg-primary {
  background: linear-gradient(145deg, #ffd700, #caa20c);
  color: #101010; border-color: #9a7d0a;
}
.theme-prestige .badge.bg-info {
  background: linear-gradient(145deg, #6b6b76, #4b4b54);
  color: #f2f2f2; border-color: #3b3b42;
}
.theme-prestige .badge.bg-success {
  background: linear-gradient(145deg, #67b26f, #4e8f57);
  color: #0f1511; border-color: #3b6b41;
}
.theme-prestige .badge.bg-danger {
  background: linear-gradient(145deg, #b24545, #872f2f);
  color: #ffeaea; border-color: #5f2121;
}

/* Модалки/баннер */
.theme-prestige .modal-content {
  background: linear-gradient(145deg, #111, #181818 60%, #0f0f0f);
  border: 1px solid var(--theme-border);
  box-shadow: 0 0 0 1px rgba(255,215,0,0.08), 0 20px 40px rgba(0,0,0,0.6);
}
.theme-prestige .alert {
  background: linear-gradient(145deg, #111, #161616);
  border-color: var(--theme-border);
  color: var(--theme-text);
}

/* Achievements — читаемость состояний */
.theme-prestige #achievements .list-group-item { transition: background .15s ease, box-shadow .15s ease; }

/* выполнено */
.theme-prestige #achievements .list-group-item.bg-success-subtle {
  background: linear-gradient(145deg, #151515, #1b1b1b);
  border-color: var(--theme-border) !important;
  border-left: 4px solid var(--theme-accent);
  box-shadow: 0 0 0 1px rgba(255,215,0,0.12), 0 8px 16px rgba(0,0,0,0.35);
}
.theme-prestige #achievements .list-group-item.bg-success-subtle strong { color: var(--theme-accent); }
.theme-prestige #achievements .list-group-item.bg-success-subtle small  { color: #e8e8e8; }

/* не выполнено */
.theme-prestige #achievements .list-group-item.bg-dark-subtle {
  background: linear-gradient(145deg, #0f0f0f, #151515);
  border-color: var(--theme-border) !important;
  border-left: 4px solid rgba(255,215,0,0.25);
}
.theme-prestige #achievements .list-group-item.bg-dark-subtle strong { color: #e0e0e0; opacity: .85; }
.theme-prestige #achievements .list-group-item.bg-dark-subtle small  { color: #bdbdbd; opacity: .9; }

/* Aizen */
.roll-slot.rarity-aizen { background: linear-gradient(145deg, #4A148C, #311B92); color: #E0E0E0; border: 1px solid #7E57C2; }

/* Aizen Traitor */
.roll-slot.rarity-aizen-traitor { background: linear-gradient(145deg, #ECEFF1, #B0BEC5); color: #212121; border: 1px solid #CFD8DC; text-shadow: 0 0 10px #80DEEA; }

/* Russian USSR */
.roll-slot.rarity-russian-ussr { background: #CC0000; color: #FFD700; border: 1px solid #FFD700; text-shadow: 1px 1px 2px #000; font-family: 'Impact', sans-serif; }

/* SSS DT */
.roll-slot.rarity-sss-dt { background: linear-gradient(160deg, #6A1B9A, #4A148C); color: #F48FB1; border: 1px solid #AB47BC; text-shadow: 0 0 8px #FF80AB; }

/* Silken Sushi */
.roll-slot.rarity-silken-sushi { background: linear-gradient(135deg, #FFCDD2, #E57373); color: #212121; border: 1px solid #EF9A9A; }

/* Russian USA */
.roll-slot.rarity-russian-usa { background: linear-gradient(135deg, #B22234, #3C3B6E); color: #FFFFFF; border: 1px solid #FFF; text-shadow: 0 0 5px #fff; }

/* Индикатор новой карты в инвентаре */
.inventory-card.new-card::after {
    content: '!';
    position: absolute;
    top: 8px;   /* <-- Сдвигаем чуть выше */
    right: 8px; /* <-- Сдвигаем чуть правее */
    width: 24px;
    height: 24px;
    background-color: #dc3545; /* <-- ИЗМЕНЯЕМ НА КРАСНЫЙ */
    color: #ffffff;           /* <-- ИЗМЕНЯЕМ НА БЕЛЫЙ */
    border-radius: 50%;
    font-size: 18px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    box-shadow: 0 0 10px #dc3545; /* <-- Добавляем красную тень */
    animation: new-card-pulse 1.5s infinite;
    z-index: 5; /* <-- Добавляем z-index на всякий случай */
}

@keyframes new-card-pulse {
    0% { transform: scale(1); box-shadow: 0 0 10px #ffc107; }
    50% { transform: scale(1.1); box-shadow: 0 0 15px #ffc107; }
    100% { transform: scale(1); box-shadow: 0 0 10px #ffc107; }
}

/* Индикатор новой версии в модальном окне */
.version-switcher-btn.new-version {
    position: relative;
    overflow: visible;
}
.version-switcher-btn.new-version::after,
.nav-tabs .nav-link.new-version::after { /* <-- ДОБАВИЛИ СЕЛЕКТОР ДЛЯ ВКЛАДОК */
    content: '!';
    position: absolute;
    top: -8px;
    right: -8px;
    width: 16px;
    height: 16px;
    background-color: #dc3545; /* <-- ИЗМЕНИЛИ ЦВЕТ НА КРАСНЫЙ */
    color: #fff; /* <-- ИЗМЕНИЛИ ЦВЕТ ТЕКСТА НА БЕЛЫЙ */
    border-radius: 50%;
    font-size: 12px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    z-index: 10; /* <-- Увеличили z-index */
    box-shadow: 0 0 8px #dc3545; /* <-- Добавили тень */
    animation: new-card-pulse 1.5s infinite; /* <-- Добавили пульсацию */
}

/* Alt Maternal (Кормящая) */
.roll-slot.rarity-alt-maternal {
    background: linear-gradient(145deg, #fff, #FFFDE7); /* От белого к кремовому */
    color: #8D6E63; /* Мягкий коричневый текст */
    text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
    border: 1px solid #D7CCC8;
    font-family: 'Georgia', serif;
}

/* Alt Witchy (Верховная) */
.roll-slot.rarity-alt-witchy {
    background: linear-gradient(160deg, #4A148C, #2c0b50);
    color: #F3E5F5;
    text-shadow: 0 0 10px #CE93D8, 0 0 5px #fff;
    border: 1px solid #7B1FA2;
    font-family: 'Cinzel Decorative', cursive;
    text-transform: uppercase;
}

/* Dionysia (Пьянящая) */
.roll-slot.rarity-dionysia {
    background: linear-gradient(135deg, #6A1B9A 0%, #4CAF50 100%); /* От фиолетового к зеленому */
    color: #F3E5F5;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.6);
    border: 1px solid #8E24AA;
    font-family: 'Playfair Display SC', serif;
}

/* Alt Mythic (Алая Королева) */
.roll-slot.rarity-alt-mythic {
    background: linear-gradient(145deg, #000, #B71C1C 80%);
    color: #FFCDD2;
    text-shadow: 0 0 8px #ff5252, 0 0 15px #ff5252;
    border: 1px solid #D32F2F;
    text-transform: uppercase;
    animation: error-text-glitch 0.2s infinite alternate;
}

/* Gojo (Безграничная) */
.roll-slot.rarity-gojo {
    background: #000;
    color: #81D4FA;
    text-shadow: 0 0 8px #81D4FA, 0 0 15px #0288D1, 0 0 20px #01579B;
    border: 1px solid #4FC3F7;
    font-family: 'Orbitron', sans-serif;
    font-weight: bold;
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-gojo::after {
    content: '';
    position: absolute; top:0; left:0; width: 100%; height: 100%;
    background: radial-gradient(circle at center, rgba(129, 212, 250, 0.2) 0%, transparent 60%);
    animation: cosmic-vortex-spin 10s linear infinite;
}

/* Kefla (Извергающаяся) */
.roll-slot.rarity-kefla {
    background: linear-gradient(160deg, #8BC34A, #33691E);
    color: #F1F8E9;
    text-shadow: 0 0 10px #C5E1A5, 0 0 20px #DCEDC8;
    border: 2px solid #AED581;
    font-family: 'Impact', sans-serif;
    text-transform: uppercase;
    animation: screen-shake 0.1s infinite;
}

/* Naruko (Обольстительная) */
.roll-slot.rarity-naruko {
    background: linear-gradient(45deg, #FFB74D, #FF7043);
    color: #fff;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
    border: 1px solid #FF9800;
    font-family: 'Quicksand', sans-serif;
    font-weight: bold;
}

/* Smoke (Дымчатая) */
.roll-slot.rarity-smoke {
    background: linear-gradient(180deg, #616161, #424242, #212121);
    color: #ECEFF1;
    text-shadow: 0 0 8px rgba(255,255,255,0.4);
    border: 1px solid #757575;
    position: relative;
}
.roll-slot.rarity-smoke > span {
    animation: smoke-text-fade 5s infinite alternate ease-in-out;
}
@keyframes smoke-text-fade {
    from { opacity: 0.7; } to { opacity: 1; }
}

/* Лэйаут */
#materialsGrid .card-body {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 16px;
  gap: 8px;
}

/* Крупные иконки материалов */
.material-icon {
  width: 192px;
  height: 192px;
  max-width: 100%;
  object-fit: contain;
  image-rendering: auto;
  border-radius: 10%;
}

@media (max-width: 992px) {
  .material-icon { width: 160px; height: 160px; }
}
@media (max-width: 576px) {
  .material-icon { width: 120px; height: 120px; }
}

/* Чуть увеличим подписи и счётчик */
#materialsGrid .card-body .fw-bold { font-size: 1.05rem; }
#materialsGrid .card-body .text-info-emphasis { font-size: 1.05rem; font-weight: 700; }

#materialsGrid .card.bg-dark-subtle { min-height: 260px; }


.roll-slot.rarity-bleached {
color: #ffe0b2; 
background:
linear-gradient(180deg, rgba(0,0,0,0.85) 0%, rgba(18,18,18,0.95) 100%),
repeating-linear-gradient(45deg, rgba(255,255,255,0.04) 0 8px, transparent 8px 16px);
border: 2px solid #ff6a00;
text-shadow: 0 0 8px #ff6a00, 0 0 16px rgba(255,106,0,0.6);
font-family: 'Orbitron', sans-serif;
}


.roll-slot.rarity-afro {
color: #f3e5f5; 
background:
radial-gradient(ellipse at 50% 10%, rgba(123,31,162,0.5) 0%, transparent 60%),
linear-gradient(160deg, #4a148c 0%, #7b1fa2 100%);
border: 1px solid #ce93d8;
text-shadow: 0 0 10px #ce93d8, 0 0 5px #ffffff;
font-family: 'Orbitron', sans-serif;
}

/* Theme: Shinigami (черный/белый/оранжевый) */
html.theme-shinigami {
  --theme-bg: #0f0f10;
  --theme-container-bg: #181818;
  --theme-text: #f0f0f0;
  --theme-accent: #ff6a00;
  --theme-accent-hover: #ff8a33;
  --theme-border: #303030;
}
.theme-shinigami body { background-color: var(--theme-bg); color: var(--theme-text); }
.theme-shinigami .tab-content, .theme-shinigami .list-group-item { background-color: var(--theme-container-bg); border-color: var(--theme-border); }
.theme-shinigami .btn-primary { background-color: var(--theme-accent); border-color: var(--theme-accent); }
.theme-shinigami .btn-primary:hover { background-color: var(--theme-accent-hover); border-color: var(--theme-accent-hover); }

/* Scrap Golem (промышленный, «ломовой») */
.roll-slot.rarity-scrap-golem {
  color: #ECEFF1;
  background:
    repeating-linear-gradient( 45deg, rgba(255,255,255,0.03) 0 8px, transparent 8px 16px ),
    linear-gradient(160deg, #37474F 0%, #263238 100%);
  border: 1px solid #BCAAA4;
  text-shadow: 0 0 8px rgba(188,170,164,0.6), 0 0 3px #000;
  font-family: 'Orbitron', sans-serif;
}

/* Theme: Obsidian (тёмный базальт + оранжево-лавовый акцент) */
html.theme-obsidian {
--theme-bg: #0b0c0e; 
--theme-container-bg: #14171b; 
--theme-text: #e6e7eb; 
--theme-accent: #ff6a00; 
--theme-accent-hover: #ff8a33; 
--theme-border: #242a30; 
color-scheme: dark;
}


.theme-obsidian body {
background-color: var(--theme-bg);
color: var(--theme-text);
position: relative;
}
.theme-obsidian body::before {
content: '';
position: fixed;
inset: 0;
pointer-events: none;
z-index: -1;
background:
radial-gradient(ellipse at 60% 20%, rgba(255,106,0,0.12), transparent 55%),
radial-gradient(ellipse at 25% 80%, rgba(255,106,0,0.08), transparent 60%),
repeating-linear-gradient( 35deg, rgba(255,255,255,0.02) 0 8px, transparent 8px 16px);
filter: saturate(1.1) contrast(1.05);
}

/* контейнеры/карточки/списки */
.theme-obsidian .tab-content,
.theme-obsidian .list-group-item {
background-color: var(--theme-container-bg);
border-color: var(--theme-border);
}
.theme-obsidian .card.bg-dark-subtle {
background-color: var(--theme-container-bg) !important;
border-color: var(--theme-border) !important;
}

/* заголовки и акценты */
.theme-obsidian h1, .theme-obsidian h2, .theme-obsidian h3, .theme-obsidian h4 {
color: var(--theme-text);
text-shadow: 0 0 6px rgba(255,106,0,0.18);
}

/* кнопки/контролы */
.theme-obsidian .btn-primary {
background-color: var(--theme-accent);
border-color: var(--theme-accent);
box-shadow: 0 0 6px rgba(255,106,0,0.35);
}
.theme-obsidian .btn-primary:hover {
background-color: var(--theme-accent-hover);
border-color: var(--theme-accent-hover);
}
.theme-obsidian .btn-outline-secondary {
color: var(--theme-text);
border-color: var(--theme-border);
}

/* вкладки */
.theme-obsidian .nav-tabs {
border-bottom-color: var(--theme-border);
}
.theme-obsidian .nav-tabs .nav-link {
color: #b9c0c6;
border-bottom-color: var(--theme-border);
}
.theme-obsidian .nav-tabs .nav-link.active {
color: var(--theme-text);
background-color: var(--theme-container-bg);
border-color: var(--theme-border) var(--theme-border) var(--theme-container-bg);
}

/* небольшие штрихи */
.theme-obsidian .badge.bg-warning {
color: #1b1d20;
}

/* Variant: Negative (инвертированные цвета) */
#cardModal.variant-negative #modalCardImage {
  filter: invert(1) hue-rotate(180deg) saturate(0.9) contrast(1.05);
}
/* Variant view in inventory grid (per-version) */
.inventory-card.variant-negative .inventory-card-image {
  filter: invert(1) hue-rotate(180deg) saturate(0.9) contrast(1.05);
}

/* GOLD: заметный тёплый фильтр + фольгированный шиммер */
#cardModal.variant-gold #modalCardImage,
.inventory-card.variant-gold .inventory-card-image {
  filter: url(#gold-emboss-filter) saturate(1.08) contrast(1.06);
  box-shadow: 0 0 16px rgba(255,215,0,0.65), 0 0 32px rgba(255,215,0,0.28);
}



#cardModal.variant-voided #modalCardImage,
.inventory-card.variant-voided .inventory-card-image {
  filter: grayscale(0.9) contrast(4) brightness(0.9) !important;
  box-shadow: 0 0 14px rgba(0,0,0,0.65), 0 0 28px rgba(0,0,0,0.35);
}

/* Маленькие бейджи для вариантов (N/G/V) */
.variant-chip {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 22px;
  height: 22px;
  padding: 0 6px;
  border-radius: 11px;
  font-size: 12px;
  font-weight: 700;
  color: #111;
  background: #ffd54f; /* по умолчанию — золотистая */
  box-shadow: 0 0 6px rgba(0,0,0,0.3);
  pointer-events: none;
}
.inventory-card.variant-voided .variant-chip,
#cardModal.variant-voided .variant-chip {
  color: #c9e3ff;
  background: #1b2633;
}
.inventory-card.variant-negative .variant-chip,
#cardModal.variant-negative .variant-chip {
  color: #111;
  background: #bdbdbd;
}


/* Orochi — ч/б хаори, «змеиные» переливы */
.roll-slot.rarity-orochi {
  color: #e0e0e0;
  background:
    repeating-linear-gradient(135deg, rgba(255,255,255,0.04) 0 8px, transparent 8px 16px),
    linear-gradient(160deg, #0e0e10 0%, #1a1b1e 100%);
  border: 1px solid #9e9e9e;
  text-shadow: 0 0 8px rgba(255,255,255,0.15);
}

/* Western — песок/солнце/золото */
.roll-slot.rarity-western {
  color: #3e2723;
  background:
    radial-gradient(ellipse at 20% 15%, rgba(255,202,40,0.25), transparent 55%),
    linear-gradient(160deg, #795548 0%, #5d4037 100%);
  border: 1px solid #ffca28;
  text-shadow: 0 0 8px rgba(255,202,40,0.6), 0 0 2px rgba(0,0,0,0.4);
}

/* Jade — кислотный изумруд */
.roll-slot.rarity-jade {
  color: #e8f5e9;
  background:
    radial-gradient(circle at 70% 20%, rgba(0,230,118,0.22), transparent 60%),
    linear-gradient(160deg, #1b5e20, #2e7d32);
  border: 1px solid #00e676;
  text-shadow: 0 0 10px rgba(0,230,118,0.6);
}

/* Gamer — фиолет/неон */
.roll-slot.rarity-gamer {
  color: #e1bee7;
  background:
    linear-gradient(180deg, rgba(49,27,146,0.6), rgba(26,0,51,0.85)),
    repeating-linear-gradient( 45deg, rgba(255,255,255,0.04) 0 6px, transparent 6px 12px);
  border: 1px solid #7e57c2;
  text-shadow: 0 0 10px #7e57c2;
}

/* Fenek — тёплый песок */
.roll-slot.rarity-fenek {
  color: #3e2723;
  background:
    radial-gradient(ellipse at 80% 10%, rgba(255,183,77,0.25), transparent 60%),
    linear-gradient(160deg, #ffcc80, #ffb74d);
  border: 1px solid #ffe0b2;
  text-shadow: 0 0 6px rgba(255,224,178,0.7);
}

/* Slime — «кубическая» слизь */
.roll-slot.rarity-slime {
  color: #e8f5e9;
  background:
    linear-gradient(135deg, rgba(56,142,60,0.9), rgba(27,94,32,0.95)),
    repeating-conic-gradient(from 0deg, rgba(255,255,255,0.04) 0% 5%, transparent 5% 10%);
  border: 1px solid #a5d6a7;
  text-shadow: 0 0 8px rgba(165,214,167,0.7);
}

/* Зловещая (Альт Годжо) */
.roll-slot.rarity-malevolent { background: linear-gradient(160deg, #1A237E, #000); color: #E8EAF6; border: 1px solid #3F51B5; text-shadow: 0 0 10px #E91E63; }

/* Бобовая */
.roll-slot.rarity-bean { background: linear-gradient(145deg, #66BB6A, #388E3C); color: #E8F5E9; border: 1px solid #81C784; }

/* Брейнрот */
.roll-slot.rarity-brainrot { background: linear-gradient(145deg, #A1887F, #795548); color: #EFEBE9; border: 1px solid #BCAAA4; }

/* Лисья (Альт Фенек) */
.roll-slot.rarity-fenek-alt { background: linear-gradient(145deg, #FFB74D, #FB8C00); color: #FFF3E0; border: 1px solid #FFCC80; }

/* Студенческая (Альт Акула) */
.roll-slot.rarity-student { background: linear-gradient(145deg, #B0BEC5, #78909c); color: #263238; border: 1px solid #CFD8DC; }

/* Акулья */
.roll-slot.rarity-shark { background: linear-gradient(145deg, #42A5F5, #1976D2); color: #E3F2FD; border: 1px solid #64B5F6; }

/* Деловая */
.roll-slot.rarity-business { background: linear-gradient(145deg, #757575, #424242); color: #FAFAFA; border: 1px solid #9E9E9E; }

/* --- Chocolate Event: Limited cards --- */

/* Missy — тёплый молочный шоколад */
.roll-slot.rarity-choco_missy {
  color: #ffe0c2;
  background: linear-gradient(145deg, #7a4b2a 0%, #9b5e34 100%);
  text-shadow: 0 0 6px rgba(255,224,194,0.6), 0 0 2px #000;
  border: 1px solid rgba(255,224,194,0.25);
}

/* Crema — карамельно-сливочная */
.roll-slot.rarity-choco_crema {
  color: #fff3e0;
  background: linear-gradient(145deg, #a87446 0%, #d6a162 100%);
  text-shadow: 0 0 6px rgba(255,243,224,0.6), 0 0 2px #000;
  border: 1px solid rgba(214,161,98,0.25);
}

/* Насыщенная (Ева в шоколаде) — плотный какао */
.roll-slot.rarity-choco_common {
  color: #ffd7b5;
  background: linear-gradient(160deg, #5b3a2e 0%, #3e2723 100%);
  text-shadow: 0 0 6px rgba(255,215,181,0.5), 0 0 2px #000;
  border: 1px solid rgba(139,90,59,0.25);
}

/* Шоколадная (Шоколадка) — сбалансированная */
.roll-slot.rarity-choco {
  color: #ffe6cc;
  background: linear-gradient(145deg, #6b3e2b 0%, #8e5a3c 100%);
  text-shadow: 0 0 6px rgba(255,230,204,0.6), 0 0 2px #000;
  border: 1px solid rgba(160,107,79,0.25);
}

/* Горькая (Эспрессо) — очень тёмная */
.roll-slot.rarity-choco_espresso {
  color: #c7a07b;
  background: linear-gradient(160deg, #2a1a14 0%, #1b0f0a 100%);
  text-shadow: 0 0 6px rgba(199,160,123,0.6), 0 0 2px #000;
  border: 1px solid rgba(89,60,43,0.35);
}

/* Белая (Белый шоколад) — светлая, сливочная */
.roll-slot.rarity-choco_white {
  color: #5e4033;
  background: linear-gradient(145deg, #fff3e0 0%, #f6e7c9 100%);
  text-shadow: 0 0 6px rgba(255,255,255,0.65);
  border: 1px solid rgba(243,229,171,0.4);
}

/* Формованная (Шоколадная пусечка) — тёмный шоколад с розовым свечением */
.roll-slot.rarity-choco_lewd {
  color: #ffd1d9;
  background:
    radial-gradient(circle at 20% 15%, rgba(255,179,198,0.18) 0%, transparent 45%),
    linear-gradient(160deg, #4a2525 0%, #7a3a3a 100%);
  text-shadow: 0 0 8px rgba(255,179,198,0.75), 0 0 2px #000;
  border: 1px solid rgba(204,122,138,0.35);
}

/* Мятная (Мисс Мята Перчинова) — холодный ментол */
.roll-slot.rarity-choco_peppermint {
  color: #c9ffe0;
  background: linear-gradient(160deg, #274036 0%, #1d2e27 100%);
  text-shadow: 0 0 8px rgba(179,255,204,0.7), 0 0 2px #000;
  border: 1px solid rgba(127,209,168,0.35);
}

/* --- Шоколадный баннер --- */
.alert.choco-banner {
  color: #f4eadf;
  background:
    radial-gradient(ellipse at 20% -10%, rgba(255, 204, 153, 0.18) 0%, transparent 50%),
    radial-gradient(ellipse at 110% 30%, rgba(255, 204, 153, 0.12) 0%, transparent 40%),
    linear-gradient(135deg, #2a1912 0%, #3a2217 55%, #4a2a1b 100%);
  border: 1px solid rgba(217, 139, 50, 0.35);
  box-shadow: inset 0 0 18px rgba(0,0,0,0.35), 0 0 16px rgba(58,34,23,0.4);
}
.alert.choco-banner .alert-heading {
  color: #ffd7a1;
  text-shadow: 0 0 8px rgba(255, 215, 161, 0.35);
}
.alert.choco-banner p {
  margin-bottom: 0.3rem;
  color: #f2e4d6;
}

/* ==========================
   THEME: CHOCO (Premium)
   ========================== */
html.theme-choco {
  /* Базовая палитра */
  --choco-bg-1: #120904;
  --choco-bg-2: #190e09;
  --choco-bg-3: #1f130d;
  --choco-tile: #2a1710;
  --choco-ink: #f7efe5;
  --choco-muted: #d7c9b8;

  --choco-accent: #d98b32;      /* карамель */
  --choco-accent-2: #f0b35e;    /* светлая карамель */
  --choco-accent-3: #8b5e3c;    /* тёмная карамель */
  --choco-border: #3c2418;

  --choco-success: #6bc37a;
  --choco-info: #f3d5a8;
  --choco-warning: #ffd188;
  --choco-danger: #f07373;

  color-scheme: dark;
}

/* Фон: плитка шоколада с мягкими высветлениями */
.theme-choco body {
  background-color: var(--choco-bg-1);
  color: var(--choco-ink);
}
.theme-choco body::before {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background:
    /* сетка плитки */
    linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px) 0 0 / 28px 28px,
    linear-gradient( 0deg, rgba(255,255,255,0.02) 1px, transparent 1px) 0 0 / 28px 28px,
    /* карамельные пятна */
    radial-gradient(circle at 14% 8%, rgba(217,139,50,0.06), transparent 45%),
    radial-gradient(circle at 80% 82%, rgba(217,139,50,0.05), transparent 40%),
    linear-gradient(135deg, var(--choco-bg-2), var(--choco-bg-3) 60%, #24160f);
  filter: saturate(1.02) contrast(1.02);
}

/* Заголовки */
.theme-choco h1, .theme-choco h2, .theme-choco h3, .theme-choco h4 {
  color: var(--choco-ink);
  text-shadow: 0 0 6px rgba(217,139,50,0.18);
}

/* Табы */
.theme-choco .nav-tabs { border-bottom-color: var(--choco-border); }
.theme-choco .nav-tabs .nav-link {
  color: var(--choco-muted);
  border-bottom-color: var(--choco-border);
  background: transparent;
}
.theme-choco .nav-tabs .nav-link.active {
  color: var(--choco-ink);
  background-color: var(--choco-bg-3);
  border-color: var(--choco-border) var(--choco-border) var(--choco-bg-3);
  position: relative;
}
.theme-choco .nav-tabs .nav-link.active::after {
  content: '';
  position: absolute;
  left: 0; right: 0; bottom: -1px;
  height: 3px;
  background: linear-gradient(90deg, transparent, var(--choco-accent), transparent);
}

/* Карточки и контейнеры */
.theme-choco .tab-content,
.theme-choco .list-group-item,
.theme-choco .card.bg-dark-subtle {
  background-color: var(--choco-bg-3) !important;
  border-color: var(--choco-border) !important;
  box-shadow: 0 0 0 1px rgba(0,0,0,0.12), 0 8px 16px rgba(0,0,0,0.35);
}

/* Инвентарь — плитка, мягкие блики */
.theme-choco .inventory-card {
  background:
    radial-gradient(circle at 12% 20%, rgba(255,255,255,0.04), transparent 30%),
    radial-gradient(circle at 88% 82%, rgba(255,255,255,0.03), transparent 30%),
    linear-gradient(135deg, #1a100b, #21140e 60%, #291a12);
  border-color: var(--choco-border);
}
.theme-choco .inventory-card-name {
  background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.82));
  color: #f4eadf;
}
.theme-choco .inventory-card:hover {
  box-shadow: 0 10px 20px rgba(0,0,0,0.55), 0 0 18px rgba(217,139,50,0.25);
}

/* LIMITED — ленточка в углу */
.theme-choco .inventory-card .badge.bg-warning {
  background: linear-gradient(145deg, #ffd188, #f0b35e);
  color: #3a2418;
  transform: rotate(-10deg);
  border: 1px solid rgba(58,36,24,0.25);
  box-shadow: 0 0 10px rgba(240,179,94,0.35);
}

/* Чип варианта (N/G/V) */
.theme-choco .variant-chip {
  background: linear-gradient(145deg, #ffe29a, #ffd188);
  color: #322015;
  border: 1px solid rgba(212,165,102,0.4);
}

/* Кнопки */
.theme-choco .btn-primary {
  background-color: var(--choco-accent);
  border-color: var(--choco-accent);
  box-shadow: 0 0 6px rgba(217,139,50,0.45);
}
.theme-choco .btn-primary:hover {
  background-color: var(--choco-accent-2);
  border-color: var(--choco-accent-2);
}
.theme-choco .btn-outline-secondary {
  color: var(--choco-ink);
  border-color: var(--choco-border);
}
.theme-choco .btn-success { background-color: #4ea761; border-color: #4ea761; }
.theme-choco .btn-danger  { background-color: #c85b5b; border-color: #c85b5b; }

/* Магазин — цены и кнопки */
.theme-choco .list-group-item .badge.bg-warning {
  background: linear-gradient(180deg, #ffd188, #f0b35e);
  color: #3a2418;
  border: 1px solid rgba(58,36,24,0.25);
}

/* Модалки */
.theme-choco .modal-content {
  background: linear-gradient(135deg, #1e130d, #28180f 60%, #311d12);
  border: 1px solid var(--choco-border);
  box-shadow: 0 0 0 1px rgba(0,0,0,0.2), 0 20px 40px rgba(0,0,0,0.55);
}
.theme-choco .modal-header {
  border-bottom-color: var(--choco-border);
  background: linear-gradient(180deg, rgba(217,139,50,0.08), rgba(0,0,0,0));
}
.theme-choco .btn-close.btn-close-white { filter: invert(0) grayscale(0); }

/* Тултипы */
.theme-choco .tooltip .tooltip-inner {
  background: #2a1710;
  color: #f4eadf;
  border: 1px solid var(--choco-border);
}

/* Слайдер громкости */
.theme-choco .form-range::-webkit-slider-runnable-track {
  background: linear-gradient(90deg, var(--choco-accent), var(--choco-accent-2));
  height: 6px; border-radius: 3px;
}
.theme-choco .form-range::-webkit-slider-thumb {
  -webkit-appearance: none;
  margin-top: -6px;
  width: 18px; height: 18px; border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #ffe6c0, #f0b35e 60%, #a7692e);
  border: 1px solid rgba(0,0,0,0.35);
  box-shadow: 0 0 8px rgba(240,179,94,0.55);
}

/* Нотификации */
.theme-choco #notificationsContainer .alert {
  background: linear-gradient(145deg, #21140e, #2a1710);
  color: var(--choco-ink);
  border: 1px solid var(--choco-border);
}
.theme-choco #notificationsContainer .alert-success { border-left: 3px solid var(--choco-success); }
.theme-choco #notificationsContainer .alert-info    { border-left: 3px solid var(--choco-accent-2); }
.theme-choco #notificationsContainer .alert-warning { border-left: 3px solid var(--choco-warning); }
.theme-choco #notificationsContainer .alert-danger  { border-left: 3px solid var(--choco-danger); }

/* Ролл-строка */
.theme-choco .roll-animation-container {
  background: linear-gradient( 180deg, #0e0806, #120a07);
  border-color: var(--choco-border);
  box-shadow: inset 0 0 12px rgba(0,0,0,0.6);
}
.theme-choco .roll-slot {
  text-shadow: 1px 1px 0 rgba(0,0,0,0.5);
}

/* Полученная карточка */
.theme-choco .received-card {
  border-color: var(--choco-accent);
  box-shadow: 0 10px 22px rgba(0,0,0,0.45), 0 0 16px rgba(217,139,50,0.25);
}

/* Баннер ивента (если активирован choco-banner) */
.theme-choco .alert.choco-banner {
  color: #f4eadf;
  background:
    radial-gradient(ellipse at 20% -10%, rgba(255, 204, 153, 0.14) 0%, transparent 50%),
    radial-gradient(ellipse at 110% 30%, rgba(255, 204, 153, 0.10) 0%, transparent 40%),
    linear-gradient(135deg, #2a1912 0%, #3a2217 55%, #4a2a1b 100%);
  border: 1px solid rgba(217, 139, 50, 0.35);
  box-shadow: inset 0 0 18px rgba(0,0,0,0.35), 0 0 16px rgba(58,34,23,0.4);
}
.theme-choco .alert.choco-banner .alert-heading {
  color: #ffd7a1;
  text-shadow: 0 0 8px rgba(255, 215, 161, 0.35);
}

/* Скроллбар (WebKit) */
.theme-choco ::-webkit-scrollbar { width: 10px; height: 10px; }
.theme-choco ::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #5a3a2e, #8e5a3c);
  border: 2px solid #1a100b;
  border-radius: 10px;
}
.theme-choco ::-webkit-scrollbar-track {
  background: #1a100b;
}

/* Включаем кремовые акценты у бейджей/иконок */
.theme-choco .badge.bg-warning { color: #3a2418; }
.theme-choco .currency-icon { filter: hue-rotate(-10deg) saturate(1.2); }

/* ==========================
   THEME CHOCO — Buttons
   ========================== */

/* Базовая форма всех кнопок в теме */
.theme-choco .btn {
  border-radius: 12px;
  border: 1px solid var(--choco-border);
  color: var(--choco-ink);
  text-shadow: 0 1px 0 rgba(0,0,0,0.35);
  transition: transform .05s ease-out, box-shadow .15s ease, background .15s ease, color .15s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.04);
}
.theme-choco .btn:active { transform: translateY(1px) scale(0.995); }
.theme-choco .btn:disabled, .theme-choco .btn.disabled {
  filter: saturate(0.7);
  opacity: 0.75;
  box-shadow: none;
}

/* Focus ring (аккуратный карамельный) */
.theme-choco .btn:focus-visible {
  outline: 2px solid var(--choco-accent-2);
  outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(240,179,94,0.25);
}

/* 1) ROLL и вариации — целевые ID + их классы */

/* Roll (btn-primary по умолчанию) */
.theme-choco #rollButton,
.theme-choco .btn-primary {
  background: linear-gradient(145deg, #d98b32 0%, #a7672a 100%);
  border-color: #8a5425;
  color: #1a100b;
  box-shadow: 0 3px 10px rgba(217,139,50,0.35), inset 0 1px 0 rgba(255,240,220,0.25);
}
.theme-choco #rollButton:hover,
.theme-choco .btn-primary:hover {
  background: linear-gradient(145deg, #f0b35e 0%, #bf7a35 100%);
  box-shadow: 0 6px 16px rgba(217,139,50,0.45);
}
.theme-choco #rollButton:active,
.theme-choco .btn-primary:active {
  background: linear-gradient(145deg, #bf7a35 0%, #8a5425 100%);
}

/* Лёгкий “глянец” для Roll */
.theme-choco #rollButton {
  position: relative;
  overflow: hidden;
}
.theme-choco #rollButton::after {
  content: "";
  position: absolute;
  inset: 0;
  background:
    linear-gradient(120deg, rgba(255,255,255,0.18) 0%, rgba(255,255,255,0.06) 40%, transparent 60%);
  opacity: 0;
  transform: translateX(-60%);
  transition: opacity .2s ease;
  pointer-events: none;
}
.theme-choco #rollButton:hover::after { opacity: 1; transform: translateX(0%); }
.theme-choco #rollButton:active::after { opacity: .9; transform: translateX(10%); }

/* Multi-Roll (btn-info по умолчанию) — “ирис/тоффи” */
.theme-choco #multiRollButton,
.theme-choco .btn-info {
  background: linear-gradient(145deg, #b87b3a 0%, #8b5e3c 100%);
  border-color: #724a2f;
  color: #fff2e0;
  box-shadow: 0 3px 10px rgba(184,123,58,0.35), inset 0 1px 0 rgba(255,230,200,0.15);
}
.theme-choco #multiRollButton:hover,
.theme-choco .btn-info:hover {
  background: linear-gradient(145deg, #d79a57 0%, #a66e49 100%);
}

/* Autoroll: в “готов” — мягкий шоколад; во “включен” (.btn-danger) — пряный какао/вишня */
.theme-choco #autorollButton.btn-success,
.theme-choco .btn-success {
  background: linear-gradient(145deg, #9c6a44 0%, #6f4b32 100%);
  border-color: #573a28;
  color: #f6eadc;
  box-shadow: 0 3px 10px rgba(156,106,68,0.35);
}
.theme-choco #autorollButton.btn-success:hover,
.theme-choco .btn-success:hover {
  background: linear-gradient(145deg, #c28a5e 0%, #8a5c3f 100%);
}

/* Autoroll включён → “остановить”: .btn-danger — тёмный какао с ягодной нотой */
.theme-choco #autorollButton.btn-danger,
.theme-choco .btn-danger {
  background: linear-gradient(145deg, #9c3a3a 0%, #6d2922 100%);
  border-color: #53201c;
  color: #ffe9e9;
  box-shadow: 0 3px 10px rgba(156,58,58,0.35);
}
.theme-choco #autorollButton.btn-danger:hover,
.theme-choco .btn-danger:hover {
  background: linear-gradient(145deg, #b54a4a 0%, #7e2f27 100%);
}

/* 2) Системные второстепенные и outline‑кнопки */

/* Secondary — шоколадная плитка */
.theme-choco .btn-secondary {
  background: linear-gradient(145deg, #2a1710 0%, #1c110b 100%);
  border-color: var(--choco-border);
  color: var(--choco-ink);
}
.theme-choco .btn-secondary:hover {
  background: linear-gradient(145deg, #3a2217 0%, #27170f 100%);
}

/* Warning — карамель */
.theme-choco .btn-warning {
  background: linear-gradient(145deg, #ffd188 0%, #f0b35e 100%);
  border-color: #d89a4d;
  color: #3a2418;
}
.theme-choco .btn-warning:hover {
  background: linear-gradient(145deg, #ffe0ab 0%, #f7c47f 100%);
}

/* Outline-варианты (заливаются шоколадом при hover) */
.theme-choco .btn-outline-primary {
  color: #f6eadc;
  border-color: #a7672a;
}
.theme-choco .btn-outline-primary:hover {
  background: linear-gradient(145deg, #d98b32 0%, #a7672a 100%);
  color: #1a100b;
}

.theme-choco .btn-outline-secondary {
  color: #f6eadc;
  border-color: var(--choco-border);
}
.theme-choco .btn-outline-secondary:hover {
  background: linear-gradient(145deg, #2a1710 0%, #1c110b 100%);
  color: var(--choco-ink);
}

.theme-choco .btn-outline-danger {
  color: #ffd7d7;
  border-color: #7e2f27;
}
.theme-choco .btn-outline-danger:hover {
  background: linear-gradient(145deg, #9c3a3a 0%, #6d2922 100%);
  color: #ffe9e9;
}

/* Смежные маленькие кнопки/чипы (например, equip/unequip) */
.theme-choco .btn-sm {
  border-radius: 10px;
}

/* Кнопка “Amplify” (ядро удачи) — визуально выделим */
.theme-choco #amplifyLuckCoreBtn {
  background: linear-gradient(145deg, #f0b35e 0%, #d98b32 100%);
  border-color: #b4762b;
  color: #3a2418;
  box-shadow: 0 4px 12px rgba(240,179,94,0.35);
}
.theme-choco #amplifyLuckCoreBtn:hover {
  background: linear-gradient(145deg, #ffd188 0%, #f0b35e 100%);
}

/* Переключатели (switch) — кремово‑карамельные */
.theme-choco .form-check-input:checked {
  background-color: #f0b35e;
  border-color: #b4762b;
  box-shadow: 0 0 0 3px rgba(240,179,94,0.25);
}

/* Кнопка закрытия модалки — деликатнее */
.theme-choco .btn-close {
  filter: invert(92%) sepia(9%) saturate(120%) hue-rotate(340deg) brightness(98%);
  opacity: .9;
}

/* ========== THEME CHOCO — Fix: badges, chips, Equipped, texts ========== */

/* Общий перехват бейджей */
.theme-choco .badge { border: 1px solid rgba(0,0,0,0.18); }

/* Luck Breakdown / Basic Stats (bg-primary → карамель) */
.theme-choco .badge.bg-primary,
.theme-choco .badge.bg-primary.rounded-pill {
  background: linear-gradient(145deg, #d98b32, #a7672a);
  color: #1a100b;
  border-color: #8a5425;
  box-shadow: 0 1px 0 rgba(255,240,220,0.25) inset, 0 0 6px rgba(217,139,50,0.25);
}

/* Информационные бейджи (Equipped, timers, и т.п.) */
.theme-choco .badge.bg-info {
  background: linear-gradient(145deg, #b87b3a, #8b5e3c);
  color: #fff2e0;
  border-color: #724a2f;
}

/* На всякий — успех/опасность (встречаются в счётчиках/итогах) */
.theme-choco .badge.bg-success {
  background: linear-gradient(145deg, #6bc37a, #4ea761);
  color: #0f1a12;
  border-color: #2f6f42;
}
.theme-choco .badge.bg-danger {
  background: linear-gradient(145deg, #b54a4a, #7e2f27);
  color: #ffe9e9;
  border-color: #53201c;
}
/* warning у нас уже карамельный выше; оставим, но подчистим границу */
.theme-choco .badge.bg-warning { border-color: #c08f4d; }

/* Текстовые акценты (строки в Luck Breakdown и ещё кое-где) */
.theme-choco .text-info    { color: var(--choco-accent-2) !important; } /* крем‑карамель */
.theme-choco .text-primary { color: var(--choco-accent)   !important; }
.theme-choco .text-success { color: #8dd69c               !important; }
.theme-choco .text-danger  { color: #f07373               !important; }

/* Equipped чипы (в магазине, блок "Надето") */
.theme-choco .equipped-item-chip {
  background: linear-gradient(145deg, #ffe0ab, #f0b35e);
  color: #3a2418;
  border: 1px solid rgba(58,36,24,0.35);
  box-shadow: 0 2px 8px rgba(240,179,94,0.25), inset 0 1px 0 rgba(255,240,220,0.25);
}
.theme-choco .equipped-item-chip .btn-remove-equip,
.theme-choco .equipped-item-chip .btn-outline-light {
  color: #3a2418;
  border-color: rgba(58,36,24,0.4);
}
.theme-choco .equipped-item-chip .btn-remove-equip:hover,
.theme-choco .equipped-item-chip .btn-outline-light:hover {
  background: rgba(58,36,24,0.08);
}

/* На всякий: чипы вариантов и лента LIMITED в инвентаре поверх img */
.theme-choco .inventory-card .variant-chip { z-index: 3; }
.theme-choco .inventory-card .badge        { z-index: 2; }

/* Жучья (Hornet) — светлый “шёлк” + алый акцент */
.roll-slot.rarity-hornet {
  color: #2b1a1a; /* тёмный текст */
  background:
    linear-gradient(145deg, #efe9e5 0%, #f7f3ef 60%, #e0d5ce 100%),
    repeating-linear-gradient(45deg, rgba(198,40,40,0.08) 0 8px, transparent 8px 16px);
  text-shadow: 0 0 6px rgba(255,255,255,0.6), 0 0 2px rgba(0,0,0,0.3);
  border: 1px solid rgba(198,40,40,0.45);
}

/* Achievements — CHOCO: различать выполненные и невыполненные */
.theme-choco #achievements .list-group-item {
  transition: background .15s ease, box-shadow .15s ease;
}

/* выполнено */
.theme-choco #achievements .list-group-item.bg-success-subtle {
  background: linear-gradient(145deg, #23160f, #2c1a11); /* чуть светлее и теплее */
  border-color: #5a3a2e !important;
  border-left: 4px solid var(--choco-accent);
  box-shadow: 0 0 0 1px rgba(217,139,50,0.12), 0 8px 16px rgba(0,0,0,0.35);
}
.theme-choco #achievements .list-group-item.bg-success-subtle strong {
  color: #ffd188; /* кремовый заголовок */
}
.theme-choco #achievements .list-group-item.bg-success-subtle small {
  color: #f2e4d6;
}

/* не выполнено */
.theme-choco #achievements .list-group-item.bg-dark-subtle {
  background: linear-gradient(145deg, #16100c, #1b120e);
  border-color: #2c1a14 !important;
  border-left: 4px solid rgba(240,179,94,0.15);
}
.theme-choco #achievements .list-group-item.bg-dark-subtle strong {
  color: #f4eadf;
  opacity: .82; /* слегка приглушить заголовок */
}
.theme-choco #achievements .list-group-item.bg-dark-subtle small {
  color: #cdbfb1;
  opacity: .85;
}

/* “новое/непрочитанное” — маленький индикатор */
.theme-choco #achievements .list-group-item.new-version {
  position: relative;
}
.theme-choco #achievements .list-group-item.new-version::after {
  content: '';
  position: absolute;
  top: 10px; right: 10px;
  width: 8px; height: 8px; border-radius: 50%;
  background: #ffd188; box-shadow: 0 0 8px rgba(240,179,94,0.6);
}

/* Achievements — CLASSIC v2 */
.theme-classic #achievements .list-group-item {
  transition: background .15s ease, box-shadow .15s ease;
}

/* выполнено */
.theme-classic #achievements .list-group-item.bg-success-subtle {
  background: linear-gradient(145deg, #3a2a2d, #452f34); /* светлее, глубже */
  border-color: var(--theme-border) !important;
  border-left: 4px solid var(--theme-accent);
  box-shadow: 0 0 0 1px rgba(183,28,28,0.12), 0 8px 16px rgba(0,0,0,0.35);
}
.theme-classic #achievements .list-group-item.bg-success-subtle strong {
  color: #ffd6d6; /* мягкий светлый заголовок */
}
.theme-classic #achievements .list-group-item.bg-success-subtle small {
  color: #f0e6e6;
}

/* не выполнено */
.theme-classic #achievements .list-group-item.bg-dark-subtle {
  background: linear-gradient(145deg, #281a1d, #322225);
  border-color: var(--theme-border) !important;
  border-left: 4px solid rgba(183,28,28,0.25);
}
.theme-classic #achievements .list-group-item.bg-dark-subtle strong {
  color: var(--theme-text);
  opacity: .85;
}
.theme-classic #achievements .list-group-item.bg-dark-subtle small {
  color: #cbb6ba;
  opacity: .9;
}

/* индикатор “нового” */
.theme-classic #achievements .list-group-item.new-version {
  position: relative;
}
.theme-classic #achievements .list-group-item.new-version::after {
  content: '';
  position: absolute;
  top: 10px; right: 10px;
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--theme-accent);
  box-shadow: 0 0 8px rgba(183,28,28,0.5);
}

/* ==========================
   THEME SALT — v2 Contrast Fix
   ========================== */

/* Базовый текст внутри карточек/списков/модалок — темнее */
.theme-salt .tab-content,
.theme-salt .list-group-item,
.theme-salt .card.bg-dark-subtle,
.theme-salt .modal-content {
  color: var(--salt-text);
}

/* muted и маленький текст — не белёсыe */
.theme-salt .text-muted,
.theme-salt small,
.theme-salt .list-group-item small,
.theme-salt .modal-content small {
  color: #506274 !important; /* темнее и спокойнее */
  opacity: 1 !important;
}

/* Заголовки в списках и карточках — читаемые, но не режут глаз */
.theme-salt .list-group-item strong,
.theme-salt .card .card-title,
.theme-salt h5, .theme-salt h6 {
  color: #2f4152; /* основной текст темы */
}

/* Навигация вкладок — не слишком светлая */
.theme-salt .nav-tabs .nav-link {
  color: #6a7d91;
}
.theme-salt .nav-tabs .nav-link:hover {
  color: #506274;
}

/* Подписи на карточках инвентаря — мягкий контраст поверх тёмного бэкграунда */
.theme-salt .inventory-card-name {
  background: rgba(15,33,52,0.55);
  color: #e7f0f8; /* была #f2f6fa — чуть темнее для мягкости */
}

/* Тултипы — читаемые на светлой теме */
.theme-salt .tooltip .tooltip-inner {
  background: #e6edf4;
  color: #2f4152;
  border: 1px solid var(--salt-border);
}

/* Ачивки — дополнительный контраст (чтобы не сливалось) */
.theme-salt #achievements .list-group-item.bg-dark-subtle strong {
  color: #2f4152;
}
.theme-salt #achievements .list-group-item.bg-dark-subtle small {
  color: #506274;
}
.theme-salt #achievements .list-group-item.bg-success-subtle strong {
  color: #3b6f99;
}
.theme-salt #achievements .list-group-item.bg-success-subtle small {
  color: #3b4f61;
}

/* ==========================
   THEME SHINIGAMI — v2 (mask & slashes)
   ========================== */

html.theme-shinigami {
  --shi-bg-1: #0f0f10;
  --shi-bg-2: #171719;
  --shi-ink: #f0f0f0;
  --shi-muted: #c9c9c9;
  --shi-accent: #ff6a00;
  --shi-accent-2: #ffa05a;
  --shi-border: #2b2c2e;
  color-scheme: dark;
}

/* Фон с лёгким «выхолощенным» градиентом и очень деликатной сеткой */
.theme-shinigami body {
  background:
    linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px) 0 0 / 30px 30px,
    linear-gradient( 0deg, rgba(255,255,255,0.02) 1px, transparent 1px) 0 0 / 30px 30px,
    radial-gradient(ellipse at 18% 10%, rgba(255,106,0,0.06), transparent 45%),
    linear-gradient(135deg, var(--shi-bg-1), var(--shi-bg-2) 55%, #121214);
  color: var(--shi-ink);
}
.theme-shinigami h1,.theme-shinigami h2,.theme-shinigami h3,.theme-shinigami h4 {
  color: var(--shi-ink);
  text-shadow: 0 0 6px rgba(255,106,0,0.14);
}

/* Контейнеры */
.theme-shinigami .tab-content,
.theme-shinigami .list-group-item,
.theme-shinigami .card.bg-dark-subtle {
  background-color: var(--shi-bg-2) !important;
  border-color: var(--shi-border) !important;
  box-shadow: 0 0 0 1px rgba(255,106,0,0.06), 0 12px 24px rgba(0,0,0,0.55);
}

/* Табы (диагональные «срезы») */
.theme-shinigami .nav-tabs { border-bottom-color: var(--shi-border); }
.theme-shinigami .nav-tabs .nav-link {
  color: #cfd0d2;
  border: 1px solid var(--shi-border);
  background: linear-gradient(145deg, #151517, #111113);
  margin-right: 6px;
  clip-path: polygon(8% 0, 100% 0, 100% 82%, 92% 100%, 0 100%, 0 18%);
  transition: background .15s, color .15s, box-shadow .15s;
}
.theme-shinigami .nav-tabs .nav-link:hover {
  color: var(--shi-ink);
}
.theme-shinigami .nav-tabs .nav-link.active {
  color: var(--shi-ink);
  background: linear-gradient(145deg, #19191c, #141416);
  position: relative;
  box-shadow: inset 0 -3px 0 var(--shi-accent);
}
.theme-shinigami .nav-tabs .nav-link.active::after { content: none !important; } /* отключаем старую линию */

/* Кнопки — агрессивные «срезы» (clip-path), fallback для старых браузеров */
.theme-shinigami .btn {
  border: 1px solid var(--shi-border);
  color: var(--shi-ink);
  text-shadow: 0 1px 0 rgba(0,0,0,0.4);
  transition: transform .05s, box-shadow .15s, background .15s, color .15s;
  box-shadow: 0 3px 10px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.05);
}
.theme-shinigami .btn:active { transform: translateY(1px) scale(0.995); }
.theme-shinigami .btn:focus-visible {
  outline: 2px solid var(--shi-accent-2); outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(255,106,0,0.25);
}

@supports (clip-path: polygon(0 0)) {
  .theme-shinigami .btn:not(.btn-close) {
    clip-path: polygon(10% 0, 100% 0, 100% 72%, 90% 100%, 0 100%, 0 18%);
    border-radius: 0;
  }
}

/* Палитра кнопок */
.theme-shinigami .btn-primary {
  background: linear-gradient(145deg, #ff6a00, #a13b00);
  border-color: #772b00; color: #0f0f10;
}
.theme-shinigami .btn-primary:hover {
  background: linear-gradient(145deg, #ffa05a, #c4500a);
}

.theme-shinigami .btn-info {
  background: linear-gradient(145deg, #3a3b3f, #27282b);
  border-color: #1f2022; color: #e7e7e7;
}
.theme-shinigami .btn-info:hover { background: linear-gradient(145deg, #484a4f, #2f3135); }

.theme-shinigami .btn-success {
  background: linear-gradient(145deg, #2c3b2f, #1d261f);
  border-color: #141a16; color: #d9efd9;
}
.theme-shinigami .btn-success:hover { background: linear-gradient(145deg, #384c3c, #233027); }

.theme-shinigami .btn-danger {
  background: linear-gradient(145deg, #812525, #5c1a1a);
  border-color: #3f1111; color: #ffeaea;
}
.theme-shinigami .btn-danger:hover { background: linear-gradient(145deg, #a13232, #712020); }

.theme-shinigami .btn-secondary {
  background: linear-gradient(145deg, #26272a, #1a1b1d);
  border-color: var(--shi-border); color: var(--shi-ink);
}
.theme-shinigami .btn-secondary:hover { background: linear-gradient(145deg, #2f3034, #202124); }

/* outline‑варианты */
.theme-shinigami .btn-outline-primary { color: var(--shi-accent); border-color: var(--shi-accent); }
.theme-shinigami .btn-outline-primary:hover { background: linear-gradient(145deg, #ff6a00, #a13b00); color: #0f0f10; }
.theme-shinigami .btn-outline-secondary { color: var(--shi-ink); border-color: var(--shi-border); }
.theme-shinigami .btn-outline-secondary:hover { background: linear-gradient(145deg, #26272a, #1a1b1d); }

/* Бейджи */
.theme-shinigami .badge { border: 1px solid rgba(0,0,0,0.25); }
.theme-shinigami .badge.bg-primary {
  background: linear-gradient(145deg, #ff6a00, #a13b00); color: #0f0f10; border-color: #772b00;
}
.theme-shinigami .badge.bg-info {
  background: linear-gradient(145deg, #3a3b3f, #27282b); color: #e7e7e7; border-color: #1f2022;
}
.theme-shinigami .badge.bg-success {
  background: linear-gradient(145deg, #2c3b2f, #1d261f); color: #d9efd9; border-color: #141a16;
}
.theme-shinigami .badge.bg-danger {
  background: linear-gradient(145deg, #812525, #5c1a1a); color: #ffeaea; border-color: #3f1111;
}

/* Ачивки — читаемость */
.theme-shinigami #achievements .list-group-item { transition: background .15s ease; }
.theme-shinigami #achievements .list-group-item.bg-success-subtle {
  background: linear-gradient(145deg, #1a1b1d, #202124);
  border-left: 4px solid var(--shi-accent);
}
.theme-shinigami #achievements .list-group-item.bg-dark-subtle {
  background: linear-gradient(145deg, #121214, #161618);
  border-left: 4px solid rgba(255,106,0,0.22);
}

/* ==========================
   THEME OBSIDIAN — v3 (blue‑violet‑black, multi‑facet)
   ========================== */

html.theme-obsidian {
  /* палитра */
  --obs-bg-1: #0a0b10;
  --obs-bg-2: #12131a;
  --obs-ink:  #e7eaff;   /* холодный «ледяной» белый */
  --obs-muted:#b5b9d0;

  --obs-violet: #7c5cff; /* фиолетовый акцент */
  --obs-cyan:   #44d3ff; /* холодный бирюзовый акцент */
  --obs-edge:   #25293a; /* сине‑чёрная грань */
  --obs-border: #2b303a;

  color-scheme: dark;
}

/* фон: холодные «всполохи» + глубокий градиент */
.theme-obsidian body {
  background:
    radial-gradient(ellipse at 70% 12%, rgba(68,211,255,0.08), transparent 55%),
    radial-gradient(ellipse at 20% 78%, rgba(124,92,255,0.08), transparent 55%),
    linear-gradient(135deg, var(--obs-bg-1), var(--obs-bg-2) 60%, #0d0f14);
  color: var(--obs-ink);
}
.theme-obsidian h1,.theme-obsidian h2,.theme-obsidian h3,.theme-obsidian h4 {
  color: var(--obs-ink);
  text-shadow: 0 0 8px rgba(124,92,255,0.18);
}

/* контейнеры */
.theme-obsidian .tab-content,
.theme-obsidian .list-group-item,
.theme-obsidian .card.bg-dark-subtle {
  background-color: var(--obs-bg-2) !important;
  border-color: var(--obs-border) !important;
  box-shadow: 0 0 0 1px rgba(124,92,255,0.06), 0 16px 28px rgba(0,0,0,0.6);
}

/* --- вкладки: «многогранные осколки» --- */
.theme-obsidian .nav-tabs { border-bottom-color: var(--obs-border); }
.theme-obsidian .nav-tabs .nav-link {
  color: #cfd3db;
  border: 1px solid var(--obs-border);
  background: linear-gradient(145deg, #111319, #0e1015);
  margin-right: 10px;
  transition: background .15s, box-shadow .15s, color .15s;
}
@supports (clip-path: polygon(0 0)) {
  .theme-obsidian .nav-tabs .nav-link {
    /* 12‑гранный «осколок» */
    clip-path: polygon(
      8% 0,   90% 0,   96% 6%,  100% 22%,
      100% 78%, 96% 94%, 92% 100%, 8% 100%,
      4% 94%,  0 78%,   0 22%,   4% 6%
    );
    border-radius: 0;
  }
}
.theme-obsidian .nav-tabs .nav-link:hover { color: var(--obs-ink); }
.theme-obsidian .nav-tabs .nav-link.active {
  color: var(--obs-ink);
  background: linear-gradient(145deg, #151822, #10131b);
  position: relative;
  /* стабильная линия акцента снизу (без ::after) */
  box-shadow: inset 0 -3px 0 rgba(124,92,255,1);
}
.theme-obsidian .nav-tabs .nav-link.active::after { content: none !important; }

/* --- кнопки: «нож/осколок» с большим числом граней --- */
.theme-obsidian .btn {
  border: 1px solid var(--obs-border);
  color: var(--obs-ink);
  text-shadow: 0 1px 0 rgba(0,0,0,0.45);
  transition: transform .05s, box-shadow .15s, background .15s, color .15s, filter .15s;
  box-shadow: 0 4px 12px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.04);
}
.theme-obsidian .btn:active { transform: translateY(1px) scale(0.995); }
.theme-obsidian .btn:focus-visible {
  outline: 2px solid var(--obs-cyan); outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(68,211,255,0.22);
}
@supports (clip-path: polygon(0 0)) {
  .theme-obsidian .btn:not(.btn-close) {
    /* 14‑гранный клинок: более «дикий» контур */
    clip-path: polygon(
      10% 0,  92% 0,   98% 8%,  100% 20%,
      96% 44%, 100% 60%, 98% 80%, 90% 100%,
      8% 100%, 2% 88%, 0 72%,  2% 48%,
      0 30%,  4% 10%
    );
    border-radius: 0;
  }
}

/* палитра кнопок (сине‑фиолетовые акценты) */
.theme-obsidian .btn-primary {
  background: linear-gradient(145deg, #7c5cff, #2b1d66);
  border-color: #22184f; color: #e7eaff;
  filter: saturate(1.06);
}
.theme-obsidian .btn-primary:hover {
  background: linear-gradient(145deg, #9a84ff, #3a2a87);
  box-shadow: 0 0 16px rgba(124,92,255,0.35);
}

.theme-obsidian .btn-info {
  background: linear-gradient(145deg, #2a3242, #1b202c);
  border-color: #141924; color: #e1e6ff;
}
.theme-obsidian .btn-info:hover { background: linear-gradient(145deg, #344059, #232b3a); }

.theme-obsidian .btn-success {
  background: linear-gradient(145deg, #234247, #172a2e);
  border-color: #102024; color: #d7f0f2;
}
.theme-obsidian .btn-success:hover { background: linear-gradient(145deg, #2d5860, #1e363b); }

.theme-obsidian .btn-danger {
  background: linear-gradient(145deg, #552b5f, #3c1d44);
  border-color: #2a1430; color: #ffe8ff;
}
.theme-obsidian .btn-danger:hover { background: linear-gradient(145deg, #6a3776, #492656); }

.theme-obsidian .btn-secondary {
  background: linear-gradient(145deg, #191c24, #12151b);
  border-color: var(--obs-border); color: var(--obs-ink);
}
.theme-obsidian .btn-secondary:hover { background: linear-gradient(145deg, #202533, #161a21); }

/* outline */
.theme-obsidian .btn-outline-primary { color: #c9c3ff; border-color: var(--obs-violet); }
.theme-obsidian .btn-outline-primary:hover { background: linear-gradient(145deg, #7c5cff, #2b1d66); color: #e7eaff; }

/* бейджи */
.theme-obsidian .badge { border: 1px solid rgba(0,0,0,0.25); }
.theme-obsidian .badge.bg-primary {
  background: linear-gradient(145deg, #7c5cff, #2b1d66); color: #e7eaff; border-color: #22184f;
}
.theme-obsidian .badge.bg-info {
  background: linear-gradient(145deg, #2a3242, #1b202c); color: #e1e6ff; border-color: #141924;
}
.theme-obsidian .badge.bg-success {
  background: linear-gradient(145deg, #234247, #172a2e); color: #d7f0f2; border-color: #102024;
}
.theme-obsidian .badge.bg-danger {
  background: linear-gradient(145deg, #552b5f, #3c1d44); color: #ffe8ff; border-color: #2a1430;
}

/* модалки — «многоугольный скол» */
.theme-obsidian .modal-content {
  background: linear-gradient(145deg, #0f1218, #151925 60%, #0e1117);
  border: 1px solid var(--obs-border);
  box-shadow: 0 0 0 1px rgba(124,92,255,0.07), 0 24px 48px rgba(0,0,0,0.7);
}
@supports (clip-path: polygon(0 0)) {
  .theme-obsidian .modal-content {
    clip-path: polygon(
      6% 0,   96% 0,   100% 8%,  100% 88%,
      94% 100%, 4% 100%, 0 90%,   0 8%
    );
    border-radius: 0;
  }
}

/* ачивки — читаемость состояний */
.theme-obsidian #achievements .list-group-item { transition: background .15s ease; }
/* выполнено */
.theme-obsidian #achievements .list-group-item.bg-success-subtle {
  background: linear-gradient(145deg, #131724, #191d2a);
  border-left: 4px solid var(--obs-violet);
  box-shadow: 0 0 0 1px rgba(124,92,255,0.12);
}
.theme-obsidian #achievements .list-group-item.bg-success-subtle strong { color: #c9c3ff; }
/* не выполнено */
.theme-obsidian #achievements .list-group-item.bg-dark-subtle {
  background: linear-gradient(145deg, #0d1016, #11141b);
  border-left: 4px solid rgba(124,92,255,0.25);
}
.theme-obsidian #achievements .list-group-item.bg-dark-subtle strong { color: #d6d9e9; opacity: .85; }
.theme-obsidian #achievements .list-group-item.bg-dark-subtle small  { color: var(--obs-muted); opacity: .9; }

/* Gyro Zeppeli — зелёные вибрации */
.roll-slot.rarity-gyro {
    background: #1b5e20;
    color: #a5d6a7;
    border: 2px solid #66bb6a;
    text-shadow: 0 0 8px #a5d6a7, 0 0 4px #66bb6a;
    font-family: 'Cinzel Decorative', cursive;
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-gyro::before {
    content: '';
    position: absolute;
    width: 200%; height: 200%;
    top: -50%; left: -50%;
    background: radial-gradient(circle, rgba(165,214,167,0.2) 1px, transparent 1px);
    background-size: 25px 25px;
    animation: gyro-spin 12s linear infinite;
}
@keyframes gyro-spin { from { transform: rotate(0deg);} to { transform: rotate(360deg);} }

/* Funny Valentine — пурпурная энергия */
.roll-slot.rarity-president {
    background: #4a148c;
    color: #f3e5f5;
    border: 2px solid #ba68c8;
    text-shadow: 0 0 8px #e1bee7, 0 0 4px #ba68c8;
    font-family: 'Cinzel Decorative', cursive;
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-president::before {
    content: '';
    position: absolute;
    width: 300%; height: 300%;
    top: -100%; left: -100%;
    background-image: repeating-linear-gradient(45deg, rgba(156,39,176,0.2) 0 10px, transparent 10px 20px);
    animation: valentine-glide 25s linear infinite;
}
@keyframes valentine-glide { from { transform: translateX(0);} to { transform: translateX(100px);} }

/* Кот Базилио — оранжево‑золотая хитрость */
.roll-slot.rarity-bazil {
    background: #e65100;
    color: #ffe0b2;
    border: 2px solid #ffb74d;
    text-shadow: 0 0 6px #ffe082, 0 0 3px #ff9800;
    font-family: 'Cinzel Decorative', cursive;
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-bazil::before {
    content: '';
    position: absolute;
    width: 150%; height: 150%;
    top: -25%; left: -25%;
    background: radial-gradient(circle, rgba(255,184,77,0.25) 15%, transparent 16%);
    background-size: 40px 40px;
    animation: bazil-pulse 8s ease-in-out infinite;
}
@keyframes bazil-pulse {
    0%,100% { transform: scale(1);}
    50% { transform: scale(1.1);}
}

/* Miyabi Hoshino — голубое сияние */
.roll-slot.rarity-miyabi {
    background: #0d47a1;
    color: #bbdefb;
    border: 2px solid #64b5f6;
    text-shadow: 0 0 7px #90caf9, 0 0 4px #2196f3;
    font-family: 'Cinzel Decorative', cursive;
    position: relative;
    overflow: hidden;
}
.roll-slot.rarity-miyabi::before {
    content: '';
    position: absolute;
    width: 200%; height: 200%;
    top: -50%; left: -50%;
    background-image: radial-gradient(circle, rgba(100,181,246,0.3) 2px, transparent 2px);
    background-size: 35px 35px;
    animation: miyabi-stars 20s linear infinite;
}
@keyframes miyabi-stars {
    from { transform: rotate(0deg);}
    to { transform: rotate(360deg);}
}
/* Хэллоуин */
.alert.halloween-banner {
  color: #f0e6ff;
  background:
    radial-gradient(ellipse at 80% 10%, rgba(255, 106, 0, 0.15) 0%, transparent 50%),
    linear-gradient(135deg, #1d112b 0%, #2a1a3d 55%, #3c245c 100%);
  border: 1px solid rgba(123, 31, 162, 0.4);
  box-shadow: inset 0 0 20px rgba(0,0,0,0.4), 0 0 18px rgba(42, 26, 61, 0.5);
}
.alert.halloween-banner .alert-heading {
  color: #ff9800;
  text-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
  font-family: 'Pirata One', cursive; /* Тематический шрифт */
  font-size: 1.8rem;
}
.alert.halloween-banner p {
  color: #e0d8f0;
}

/* <<< НАЧАЛО: ПОЛНАЯ ТЕМА ХЭЛЛОУИН 2025 (V2) >>> */
html.theme-halloween {
  --hween-bg-1: #0d0c14;
  --hween-bg-2: #141120;
  --hween-bg-3: #191629;
  --hween-tile: #1c1a29;
  --hween-ink: #e8e4f5;
  --hween-muted: #c0b8e0;

  --hween-accent: #ff9800;      /* тыквенный оранжевый */
  --hween-accent-2: #ffb74d;    /* светлый оранжевый */
  --hween-accent-3: #e65100;    /* тёмный оранжевый */
  --hween-border: #332d4a;
  
  --hween-purple: #7b1fa2;      /* зловещий фиолетовый */
  --hween-green: #558b2f;       /* болотный зелёный */
  --hween-red: #d32f2f;         /* кровавый красный */

  color-scheme: dark;
}

.theme-halloween body {
  background-color: var(--hween-bg-1);
  color: var(--hween-ink);
}
.theme-halloween body::before {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background:
    /* SVG летучих мышей */
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 10 C 40 20, 10 20, 0 10 L 25 50 L 0 90 C 10 80, 40 80, 50 90 C 60 80, 90 80, 100 90 L 75 50 L 100 10 C 90 20, 60 20, 50 10 Z" fill="rgba(255, 152, 0, 0.03)"/></svg>') 0 0 / 150px 150px,
    radial-gradient(ellipse at 15% 85%, rgba(123, 31, 162, 0.09), transparent 50%),
    radial-gradient(ellipse at 85% 15%, rgba(255, 152, 0, 0.08), transparent 50%),
    linear-gradient(135deg, var(--hween-bg-1), var(--hween-bg-2) 60%, var(--hween-bg-3));
}
.theme-halloween h1, .theme-halloween h2, .theme-halloween h3, .theme-halloween h4 {
  color: var(--hween-accent);
  font-family: 'Pirata One', cursive;
  text-shadow: 0 0 8px rgba(255, 152, 0, 0.35);
}
.theme-halloween .tab-content, .theme-halloween .list-group-item, .theme-halloween .card.bg-dark-subtle {
  background-color: var(--hween-tile) !important;
  border-color: var(--hween-border) !important;
  box-shadow: 0 8px 24px rgba(0,0,0,0.6), inset 0 0 10px rgba(29, 23, 41, 0.5);
}
.theme-halloween .nav-tabs { border-bottom-color: var(--hween-border); }
.theme-halloween .nav-tabs .nav-link {
  color: var(--hween-muted);
  border-bottom-color: var(--hween-border);
}
.theme-halloween .nav-tabs .nav-link.active {
  color: var(--hween-accent);
  background-color: var(--hween-tile);
  border-color: var(--hween-border) var(--hween-border) var(--hween-tile);
  position: relative;
}
.theme-halloween .nav-tabs .nav-link.active::after {
  content: '';
  position: absolute; left:0; right:0; bottom:-1px; height:3px;
  background: linear-gradient(90deg, transparent, var(--hween-accent), transparent);
}
.theme-halloween .inventory-card:hover {
  box-shadow: 0 8px 16px rgba(0,0,0,0.6), 0 0 18px var(--rarity-glow-color, #ff9800);
}

/* Кнопки */
.theme-halloween .btn {
  border-radius: 4px;
  border: 1px solid var(--hween-border);
  color: var(--hween-ink);
  text-shadow: 0 1px 0 rgba(0,0,0,0.4);
  transition: all .15s ease-out;
  box-shadow: 0 2px 8px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.06);
}
.theme-halloween .btn:active { transform: translateY(1px); }
.theme-halloween .btn:focus-visible {
  outline: 2px solid var(--hween-accent-2); outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(255,152,0,0.25);
}
.theme-halloween .btn-primary {
  background: linear-gradient(145deg, var(--hween-accent), var(--hween-accent-3));
  border-color: #a13b00; color: #111;
  box-shadow: 0 3px 12px rgba(255,152,0,0.3);
}
.theme-halloween .btn-primary:hover { background: linear-gradient(145deg, var(--hween-accent-2), var(--hween-accent)); }
.theme-halloween .btn-info { background: linear-gradient(145deg, #4a4166, #332d4a); border-color: #2b263b; }
.theme-halloween .btn-info:hover { background: linear-gradient(145deg, #5c5280, #3e375c); }
.theme-halloween .btn-success { background: linear-gradient(145deg, var(--hween-green), #33691e); border-color: #2e5c1a; color: #e8f5e9;}
.theme-halloween .btn-danger { background: linear-gradient(145deg, var(--hween-red), #8e0000); border-color: #7f0000; color: #ffeaea;}
.theme-halloween .btn-secondary { background: linear-gradient(145deg, #2c293d, #1c1a29); border-color: var(--hween-border); }
.theme-halloween .btn-outline-primary { color: var(--hween-accent); border-color: var(--hween-accent); }
.theme-halloween .btn-outline-primary:hover { background: var(--hween-accent); color: #111; }

/* Бейджи */
.theme-halloween .badge.bg-primary { background: linear-gradient(145deg, var(--hween-accent), var(--hween-accent-3)); color: #111; }
.theme-halloween .badge.bg-info { background: linear-gradient(145deg, #4a4166, #332d4a); }
.theme-halloween .badge.bg-success { background: linear-gradient(145deg, var(--hween-green), #33691e); color: #e8f5e9; }
.theme-halloween .badge.bg-danger { background: linear-gradient(145deg, var(--hween-red), #8e0000); color: #ffeaea; }
.theme-halloween .badge.bg-warning { background: linear-gradient(145deg, var(--hween-accent-2), var(--hween-accent)); color: #111; }

/* Модалки и Алерт */
.theme-halloween .modal-content {
  background: linear-gradient(135deg, #141120, #191629);
  border: 1px solid var(--hween-border);
  box-shadow: 0 15px 40px rgba(0,0,0,0.7);
}
.theme-halloween .alert { background: linear-gradient(145deg, #191629, #141120); border-color: var(--hween-border); }

/* Скроллбар */
.theme-halloween ::-webkit-scrollbar { width: 10px; }
.theme-halloween ::-webkit-scrollbar-thumb { background: linear-gradient(180deg, var(--hween-accent-3), var(--hween-purple)); border: 2px solid #0d0c14; border-radius: 10px; }
.theme-halloween ::-webkit-scrollbar-track { background: #0d0c14; }
/* <<< КОНЕЦ: ПОЛНАЯ ТЕМА ХЭЛЛОУИН 2025 (V2) >>> */

/* ===================================================================
   THEME: CREEPYPASTA (FEAR/HORROR/STATIC/BLOOD)
   =================================================================== */

html.theme-creepypasta {
  /* Палитра: Черный, Белый шум, Кровь */
  --creepy-bg-1: #0a0a0a;
  --creepy-bg-2: #121212;
  --creepy-bg-3: #1a1a1a;
  --creepy-tile: #1e1e1e;
  --creepy-ink: #c0c0c0;      /* Белёсый, "выцветший" текст */
  --creepy-muted: #777777;

  --creepy-accent-red: #a00000;    /* Тёмная, "засохшая" кровь */
  --creepy-accent-red-hover: #d32f2f; /* Яркая, "свежая" кровь */
  --creepy-border: #2a2a2a;
  
  --creepy-static-1: rgba(255, 255, 255, 0.03);
  --creepy-static-2: rgba(255, 255, 255, 0.05);

  color-scheme: dark;
}

/* Фон: Анимированный "белый шум" (помехи) */
.theme-creepypasta body {
  background-color: var(--creepy-bg-1);
  color: var(--creepy-ink);
}
.theme-creepypasta body::before {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background:
    /* Анимированный шум */
    repeating-linear-gradient(var(--creepy-static-1) 0 1px, transparent 1px 100%),
    repeating-linear-gradient(90deg, var(--creepy-static-2) 0 1px, transparent 1px 100%);
  background-size: 100% 3px, 3px 100%;
  animation: static-flicker 0.15s infinite linear;
}
@keyframes static-flicker {
  0%   { background-position: 0 0, 0 0; }
  10%  { background-position: 5px 3px, -2px 4px; }
  20%  { background-position: -3px 6px, 3px -5px; }
  30%  { background-position: 8px -2px, -7px 2px; }
  40%  { background-position: -1px 5px, 5px 8px; }
  50%  { background-position: 4px -4px, -3px -3px; }
  60%  { background-position: 9px 1px, 2px 5px; }
  70%  { background-position: -4px 7px, 6px -1px; }
  80%  { background-position: 2px -3px, -1px 9px; }
  90%  { background-position: 7px 4px, -5px -4px; }
  100% { background-position: 0 0, 0 0; }
}

/* Заголовки: Тревожные, с красным свечением */
.theme-creepypasta h1, .theme-creepypasta h2, .theme-creepypasta h3, .theme-creepypasta h4 {
  color: #f0f0f0;
  text-shadow: 0 0 6px rgba(160, 0, 0, 0.35), 0 0 2px rgba(255, 0, 0, 0.2);
}

/* Табы: Резкие, с кровавым акцентом */
.theme-creepypasta .nav-tabs { border-bottom-color: var(--creepy-border); }
.theme-creepypasta .nav-tabs .nav-link {
  color: var(--creepy-muted);
  border-bottom-color: var(--creepy-border);
  background: transparent;
  border-radius: 0;
}
.theme-creepypasta .nav-tabs .nav-link.active {
  color: var(--creepy-ink);
  background-color: var(--creepy-bg-3);
  border-color: var(--creepy-border) var(--creepy-border) var(--creepy-bg-3);
  position: relative;
  box-shadow: inset 0 -3px 0 var(--creepy-accent-red);
}
.theme-creepypasta .nav-tabs .nav-link.active::after { content: none; }

/* Контейнеры, списки, карточки: Глубокий черный */
.theme-creepypasta .tab-content,
.theme-creepypasta .list-group-item,
.theme-creepypasta .card.bg-dark-subtle {
  background-color: var(--creepy-bg-3) !important;
  border-color: var(--creepy-border) !important;
  box-shadow: 0 0 0 1px rgba(0,0,0,0.12), 0 10px 22px rgba(0,0,0,0.45);
}

/* Инвентарь: Кровавая рамка при наведении */
.theme-creepypasta .inventory-card {
  background: linear-gradient(135deg, #0e0e0e, #141414);
  border-color: var(--creepy-border);
}
.theme-creepypasta .inventory-card-name {
  background: linear-gradient(180deg, rgba(100,0,0,0.6), rgba(160,0,0,0.8));
  color: #f2e4d6;
}
.theme-creepypasta .inventory-card:hover {
  box-shadow: 0 10px 20px rgba(0,0,0,0.55), 0 0 18px var(--creepy-accent-red);
}
.theme-creepypasta .inventory-card .badge.bg-warning {
  background: linear-gradient(145deg, var(--creepy-accent-red-hover), var(--creepy-accent-red));
  color: #ffeaea;
  border: 1px solid rgba(255,0,0,0.25);
  box-shadow: 0 0 10px rgba(211,47,47,0.35);
}

/* --- Кнопки (Стиль "Кровь") --- */
.theme-creepypasta .btn {
  border-radius: 6px;
  border: 1px solid var(--creepy-border);
  color: var(--creepy-ink);
  text-shadow: 0 1px 0 rgba(0,0,0,0.35);
  transition: all .1s ease-out;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.02);
}
.theme-creepypasta .btn:active { transform: translateY(1px) scale(0.99); }
.theme-creepypasta .btn:focus-visible {
  outline: 2px solid var(--creepy-accent-red-hover);
  outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(211,47,47,0.25);
}

/* Primary (Roll) — КРОВЬ */
.theme-creepypasta .btn-primary {
  background: linear-gradient(145deg, var(--creepy-accent-red) 0%, #6d0000 100%);
  border-color: #530000;
  color: #ffeaea;
  box-shadow: 0 3px 10px rgba(160,0,0,0.35), inset 0 1px 0 rgba(255,100,100,0.15);
}
.theme-creepypasta .btn-primary:hover {
  background: linear-gradient(145deg, var(--creepy-accent-red-hover) 0%, #8e0000 100%);
  box-shadow: 0 6px 16px rgba(211,47,47,0.45);
}

/* Info (Multi-Roll) — Мертвый/Серый */
.theme-creepypasta .btn-info {
  background: linear-gradient(145deg, #4a4a4a 0%, #303030 100%);
  border-color: #222222;
  color: #c0c0c0;
}
.theme-creepypasta .btn-info:hover { background: linear-gradient(145deg, #5c5c5c 0%, #3a3a3a 100%); }

/* Success (Autoroll Ready) — Болотный/Гнилой */
.theme-creepypasta .btn-success {
  background: linear-gradient(145deg, #556b2f 0%, #334d1a 100%);
  border-color: #2a3f1a;
  color: #e8f5e9;
}
.theme-creepypasta .btn-success:hover { background: linear-gradient(145deg, #6b8e3a 0%, #4a6b2a 100%); }

/* Danger (Autoroll Stop) — ЯРКАЯ КРОВЬ */
.theme-creepypasta .btn-danger {
  background: linear-gradient(145deg, var(--creepy-accent-red-hover) 0%, #a00000 100%);
  border-color: #7f0000;
  color: #ffeaea;
  box-shadow: 0 3px 10px rgba(211,47,47,0.35);
}
.theme-creepypasta .btn-danger:hover { background: linear-gradient(145deg, #eb4444 0%, #b50f0f 100%); }

/* Secondary (Default) — Тьма */
.theme-creepypasta .btn-secondary {
  background: linear-gradient(145deg, #2a2a2a 0%, #1c1c1c 100%);
  border-color: var(--creepy-border);
}
.theme-creepypasta .btn-secondary:hover { background: linear-gradient(145deg, #3a3a3a 0%, #272727 100%); }

/* Outlines */
.theme-creepypasta .btn-outline-primary { color: #ffcdd2; border-color: var(--creepy-accent-red); }
.theme-creepypasta .btn-outline-primary:hover { background: var(--creepy-accent-red); color: #ffeaea; }
.theme-creepypasta .btn-outline-secondary { color: var(--creepy-ink); border-color: var(--creepy-border); }
.theme-creepypasta .btn-outline-secondary:hover { background: #2a2a2a; color: var(--creepy-ink); }
.theme-creepypasta .btn-outline-danger { color: #ffcdd2; border-color: var(--creepy-accent-red-hover); }
.theme-creepypasta .btn-outline-danger:hover { background: var(--creepy-accent-red-hover); color: #ffeaea; }

/* --- Бейджи и Акценты --- */
.theme-creepypasta .badge { border: 1px solid rgba(0,0,0,0.18); }
.theme-creepypasta .badge.bg-primary { background: linear-gradient(145deg, var(--creepy-accent-red), #6d0000); color: #ffeaea; }
.theme-creepypasta .badge.bg-info { background: linear-gradient(145deg, #4a4a4a, #303030); color: #c0c0c0; }
.theme-creepypasta .badge.bg-success { background: linear-gradient(145deg, #556b2f, #334d1a); color: #e8f5e9; }
.theme-creepypasta .badge.bg-danger { background: linear-gradient(145deg, var(--creepy-accent-red-hover), #a00000); color: #ffeaea; }
.theme-creepypasta .badge.bg-warning { background: linear-gradient(145deg, #e65100, #bf360c); color: #fff3e0; }

.theme-creepypasta .text-info    { color: #9e9e9e !important; }
.theme-creepypasta .text-primary { color: var(--creepy-accent-red) !important; }
.theme-creepypasta .text-success { color: #8f9a6d !important; }
.theme-creepypasta .text-danger  { color: var(--creepy-accent-red-hover) !important; }
.theme-creepypasta .text-warning { color: #ff9800 !important; }

/* Equipped чипы в магазине */
.theme-creepypasta .equipped-item-chip {
  background: linear-gradient(145deg, #4a4a4a, #303030);
  color: #c0c0c0;
  border: 1px solid #222222;
  box-shadow: none;
}
.theme-creepypasta .equipped-item-chip .btn-remove-equip { color: #c0c0c0; border-color: #555; }
.theme-creepypasta .equipped-item-chip .btn-remove-equip:hover { background: rgba(0,0,0,0.2); }

/* Модалки и Баннеры */
.theme-creepypasta .modal-content {
  background: linear-gradient(135deg, #121212, #1a1a1a);
  border: 1px solid var(--creepy-border);
  box-shadow: 0 0 0 1px rgba(0,0,0,0.2), 0 20px 40px rgba(0,0,0,0.65);
}
.theme-creepypasta .modal-header { border-bottom-color: var(--creepy-border); }
.theme-creepypasta .alert { background: linear-gradient(145deg, #1e1e1e, #141414); border-color: var(--creepy-border); }
.theme-creepypasta .alert.halloween-banner { /* Перекрашиваем баннер Хэллоуина, если он активен */
  background: linear-gradient(135deg, #1e1e1e, #141414);
  border-color: var(--creepy-accent-red);
}
.theme-creepypasta .alert.halloween-banner .alert-heading { color: var(--creepy-accent-red); }

/* Слайдер и Скроллбар */
.theme-creepypasta .form-range::-webkit-slider-runnable-track { background: #333; }
.theme-creepypasta .form-range::-webkit-slider-thumb {
  background: radial-gradient(circle at 30% 30%, #ffcdd2, var(--creepy-accent-red) 60%, #6d0000);
  border: 1px solid rgba(0,0,0,0.35);
  box-shadow: 0 0 8px rgba(160,0,0,0.55);
}
.theme-creepypasta ::-webkit-scrollbar-thumb { background: linear-gradient(180deg, #4a4a4a, #303030); border: 2px solid #0a0a0a; }
.theme-creepypasta ::-webkit-scrollbar-track { background: #0a0a0a; }

/* Ролл-строка */
.theme-creepypasta .roll-animation-container {
  background: linear-gradient(180deg, #000, #0a0a0a);
  border-color: var(--creepy-border);
  box-shadow: inset 0 0 12px rgba(0,0,0,0.8);
}
.theme-creepypasta .roll-slot { text-shadow: 1px 1px 0 rgba(0,0,0,0.5); }
.theme-creepypasta .received-card { border-color: var(--creepy-accent-red); }

/* Ачивки */
.theme-creepypasta #achievements .list-group-item.bg-success-subtle {
  background: linear-gradient(145deg, #1f1f1f, #2a2a2a);
  border-color: var(--creepy-border) !important;
  border-left: 4px solid var(--creepy-accent-red);
}
.theme-creepypasta #achievements .list-group-item.bg-success-subtle strong { color: #ffcdd2; }
.theme-creepypasta #achievements .list-group-item.bg-dark-subtle {
  background: linear-gradient(145deg, #101010, #161616);
  border-color: #222 !important;
  border-left: 4px solid rgba(160,0,0,0.25);
}
.theme-creepypasta #achievements .list-group-item.bg-dark-subtle strong { color: var(--creepy-ink); opacity: .85; }
.theme-creepypasta #achievements .list-group-item.bg-dark-subtle small  { color: var(--creepy-muted); opacity: .9; }
.theme-creepypasta #achievements .list-group-item.new-version::after {
  background: var(--creepy-accent-red);
  box-shadow: 0 0 8px rgba(160,0,0,0.5);
}